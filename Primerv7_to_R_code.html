<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.0.37">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Hafez Ahmad">

<title>Primerv7 to R code with R 4.12</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="Primerv7_to_R_code_files/libs/clipboard/clipboard.min.js"></script>
<script src="Primerv7_to_R_code_files/libs/quarto-html/quarto.js"></script>
<script src="Primerv7_to_R_code_files/libs/quarto-html/popper.min.js"></script>
<script src="Primerv7_to_R_code_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="Primerv7_to_R_code_files/libs/quarto-html/anchor.min.js"></script>
<link href="Primerv7_to_R_code_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="Primerv7_to_R_code_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="Primerv7_to_R_code_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="Primerv7_to_R_code_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="Primerv7_to_R_code_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Primerv7 to R code with R 4.12</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Hafez Ahmad </p>
          </div>
  </div>
    
    
  </div>
  

</header>

<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(vegan)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(pheatmap)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(cluster)    <span class="co"># clustering algorithms</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(factoextra) <span class="co"># clustering visualization</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dendextend) <span class="co"># for comparing two dendrograms</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="day-1" class="level2">
<h2 class="anchored" data-anchor-id="day-1">Day 1</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(janitor)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'janitor'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:stats':

    chisq.test, fisher.test</code></pre>
</div>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>ekofish<span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"E:/1 Master's/MSU/course classes/Fall 2022/WFA 7000 FALL2022/materials/primerv7/Practicals/Prac_04/Ekofisk environment.xls"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>New names:
* `` -&gt; ...2
* `` -&gt; ...3
* `` -&gt; ...4
* `` -&gt; ...5
* `` -&gt; ...6
* ...</code></pre>
</div>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># rename column</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(ekofish)<span class="ot">&lt;-</span>ekofish[<span class="dv">1</span>,]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: The `value` argument of `names&lt;-` can't be empty as of tibble 3.0.0.
Columns 1 and 12 must be named.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: The `value` argument of `names&lt;-` must be a character vector as of
tibble 3.0.0.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(ekofish)[<span class="dv">1</span>]<span class="ot">&lt;-</span><span class="st">"site"</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="co"># remove first row</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>ekofish<span class="ot">&lt;-</span> ekofish[<span class="sc">-</span>(<span class="dv">1</span>),]</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Null column</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>ekofish[,<span class="dv">12</span>]<span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(ekofish)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 x 13
  site  Distance   THC   Redox `%Mud`  `Phi mean`  Ba    Sr    Cu    Pb    Ni   
  &lt;chr&gt; &lt;chr&gt;      &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;   &lt;chr&gt;       &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;
1 S30   0.1000000~ 232   80    11.91   3.22000000~ 1967  587   97    65    14   
2 S36   0.1000000~ 443   189   10.949~ 3.29999999~ 1997  509   8     43    10   
3 S37   0.1000000~ 1896  85    12.289~ 3.18000000~ 1913  836   22    88    13   
4 S31   0.1499999~ 251   124   7.5800~ 3.10999999~ 1922  498   14    38    16   
5 S3    0.25       17    142   4.9400~ 3.06999999~ 3608  278   5     25    6    
6 S35   0.25       56    153   8.3000~ 3.04999999~ 3143  302   5     23    10   
# ... with 2 more variables: Dist# &lt;chr&gt;, Dist &lt;chr&gt;</code></pre>
</div>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># clean column names</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>ekofish <span class="ot">&lt;-</span> ekofish <span class="sc">%&gt;%</span> <span class="fu">clean_names</span>()</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(ekofish)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 x 13
  site  distance  thc   redox percent_mud phi_mean ba    sr    cu    pb    ni   
  &lt;chr&gt; &lt;chr&gt;     &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;       &lt;chr&gt;    &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;
1 S30   0.100000~ 232   80    11.91       3.22000~ 1967  587   97    65    14   
2 S36   0.100000~ 443   189   10.9499999~ 3.29999~ 1997  509   8     43    10   
3 S37   0.100000~ 1896  85    12.2899999~ 3.18000~ 1913  836   22    88    13   
4 S31   0.149999~ 251   124   7.58000000~ 3.10999~ 1922  498   14    38    16   
5 S3    0.25      17    142   4.94000000~ 3.06999~ 3608  278   5     25    6    
6 S35   0.25      56    153   8.30000000~ 3.04999~ 3143  302   5     23    10   
# ... with 2 more variables: dist_number &lt;chr&gt;, dist &lt;chr&gt;</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># convert convert dist_number and dist column as factor</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>ekofish<span class="sc">$</span>dist_number <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(ekofish<span class="sc">$</span>dist_number)</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>ekofish<span class="sc">$</span>dist <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(ekofish<span class="sc">$</span>dist)</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a><span class="co"># convert other colunms as numeric if they are character </span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>ekofish[,<span class="dv">2</span><span class="sc">:</span><span class="dv">11</span>]<span class="ot">&lt;-</span> <span class="fu">sapply</span>(ekofish[,<span class="dv">2</span><span class="sc">:</span><span class="dv">11</span>], as.numeric)</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(ekofish)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 x 13
  site  distance   thc redox percent_mud phi_mean    ba    sr    cu    pb    ni
  &lt;chr&gt;    &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;       &lt;dbl&gt;    &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1 S30       0.1    232    80       11.9      3.22  1967   587    97    65    14
2 S36       0.1    443   189       11.0      3.3   1997   509     8    43    10
3 S37       0.1   1896    85       12.3      3.18  1913   836    22    88    13
4 S31       0.15   251   124        7.58     3.11  1922   498    14    38    16
5 S3        0.25    17   142        4.94     3.07  3608   278     5    25     6
6 S35       0.25    56   153        8.3      3.05  3143   302     5    23    10
# ... with 2 more variables: dist_number &lt;fct&gt;, dist &lt;fct&gt;</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># descriptive statistics</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(ekofish)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     site              distance          thc              redox      
 Length:39          Min.   :0.100   Min.   :   8.00   Min.   :-25.0  
 Class :character   1st Qu.:0.500   1st Qu.:  11.00   1st Qu.:123.0  
 Mode  :character   Median :1.600   Median :  14.00   Median :143.0  
                    Mean   :2.432   Mean   :  98.13   Mean   :148.0  
                    3rd Qu.:3.650   3rd Qu.:  38.50   3rd Qu.:178.5  
                    Max.   :8.000   Max.   :1896.00   Max.   :240.0  
  percent_mud        phi_mean           ba               sr       
 Min.   : 0.640   Min.   :2.830   Min.   : 329.0   Min.   : 51.0  
 1st Qu.: 3.875   1st Qu.:2.960   1st Qu.: 833.5   1st Qu.: 71.5  
 Median : 4.670   Median :3.010   Median :1922.0   Median :107.0  
 Mean   : 5.207   Mean   :3.023   Mean   :1844.6   Mean   :173.7  
 3rd Qu.: 5.770   3rd Qu.:3.070   3rd Qu.:2478.5   3rd Qu.:189.0  
 Max.   :12.290   Max.   :3.300   Max.   :4913.0   Max.   :836.0  
       cu               pb              ni        dist_number dist  
 Min.   : 2.000   Min.   : 6.00   Min.   : 3.00   1: 6        A:11  
 1st Qu.: 3.000   1st Qu.:12.00   1st Qu.: 5.50   2:10        B:12  
 Median : 3.000   Median :15.00   Median : 7.00   3:12        C:10  
 Mean   : 6.564   Mean   :20.49   Mean   : 9.41   4:11        D: 6  
 3rd Qu.: 4.000   3rd Qu.:24.50   3rd Qu.: 8.00                     
 Max.   :97.000   Max.   :88.00   Max.   :54.00                     </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(ekofish)<span class="ot">&lt;-</span>ekofish<span class="sc">$</span>site</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Setting row names on a tibble is deprecated.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># select only the columns that are numeric</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>ekofish<span class="ot">&lt;-</span>ekofish <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="fu">where</span>(is.numeric))</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(ekofish)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 x 10
  distance   thc redox percent_mud phi_mean    ba    sr    cu    pb    ni
     &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;       &lt;dbl&gt;    &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1     0.1    232    80       11.9      3.22  1967   587    97    65    14
2     0.1    443   189       11.0      3.3   1997   509     8    43    10
3     0.1   1896    85       12.3      3.18  1913   836    22    88    13
4     0.15   251   124        7.58     3.11  1922   498    14    38    16
5     0.25    17   142        4.94     3.07  3608   278     5    25     6
6     0.25    56   153        8.3      3.05  3143   302     5    23    10</code></pre>
</div>
</div>
<div class="cell">

</div>
<p>Distance matrix calculation: Available methods are euclidean , manhattan, canberra, braycurtis, kulczynski, minkowski, rogerstanimoto, russellrao, sokalmichener, sokalsneath, and wminkowski.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># remove na</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>ekofish<span class="ot">&lt;-</span> <span class="fu">na.omit</span>(ekofish)</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a><span class="co"># standardizing data</span></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>df<span class="ot">&lt;-</span> <span class="fu">scale</span>(ekofish)</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a><span class="co"># dissimilarity matrix(</span></span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>dissimilarity_matrix<span class="ot">&lt;-</span> <span class="fu">dist</span>(df, <span class="at">method=</span><span class="st">"euclidean"</span>)</span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a><span class="co"># similarity matrix</span></span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>similarity_matrix<span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> dissimilarity_matrix</span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a><span class="co"># hierarchical clustering using complete linkage</span></span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>hc<span class="ot">&lt;-</span> <span class="fu">hclust</span>(dissimilarity_matrix, <span class="at">method=</span><span class="st">"complete"</span>) <span class="co">#agglomerative clustering</span></span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a><span class="co"># decisive clusters</span></span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a><span class="co">#clusters&lt;- diana(hc, k=3)</span></span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a><span class="co"># plot the dendrogram</span></span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(hc)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Primerv7_to_R_code_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co"># algglomerative coefficients(</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>hc2<span class="ot">&lt;-</span> <span class="fu">agnes</span>(df, <span class="at">method=</span><span class="st">"complete"</span>)</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>hc2<span class="sc">$</span>ac</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.8435725</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co"># methods to assess</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">c</span>( <span class="st">"average"</span>, <span class="st">"single"</span>, <span class="st">"complete"</span>, <span class="st">"ward"</span>)</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(m) <span class="ot">&lt;-</span> <span class="fu">c</span>( <span class="st">"average"</span>, <span class="st">"single"</span>, <span class="st">"complete"</span>, <span class="st">"ward"</span>)</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate the dendrogram for each method</span></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>ac<span class="ot">&lt;-</span> <span class="cf">function</span> (x){</span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">agnes</span>(df, <span class="at">method=</span>x)<span class="sc">$</span>ac</span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a><span class="co"># for loop apply to df  and ac function</span></span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(m)){</span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(<span class="fu">paste0</span>(m[i],<span class="st">' : '</span>,(<span class="fu">ac</span>(m[i]))))</span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "average : 0.804571301430129"
[1] "single : 0.751469648387409"
[1] "complete : 0.843572536919754"
[1] "ward : 0.889574149142946"</code></pre>
</div>
</div>
<p>k=4 main group</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_dend</span>(hc,<span class="at">k=</span><span class="dv">4</span>,<span class="at">cex=</span><span class="fl">0.5</span>,<span class="at">main =</span> <span class="st">"Dendrogram - ward.D2"</span>,</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>          <span class="at">xlab =</span> <span class="st">"Objects"</span>, <span class="at">ylab =</span> <span class="st">"Distance"</span>, <span class="at">sub =</span> <span class="st">""</span>,<span class="at">k_colors =</span> <span class="fu">c</span>(<span class="st">"#2E9FDF"</span>, <span class="st">"#00AFBB"</span>, <span class="st">"#E7B800"</span>, <span class="st">"#FC4E07"</span>),</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">color_labels_by_k =</span> <span class="cn">TRUE</span>,  <span class="co"># color labels by groups</span></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>          <span class="at">ggtheme =</span> <span class="fu">theme_gray</span>()     <span class="co"># Change theme)</span></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: `guides(&lt;scale&gt; = FALSE)` is deprecated. Please use `guides(&lt;scale&gt; =
"none")` instead.</code></pre>
</div>
<div class="cell-output-display">
<p><img src="Primerv7_to_R_code_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. Create a customized dendrogram</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>mycols <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"#2E9FDF"</span>, <span class="st">"#00AFBB"</span>, <span class="st">"#E7B800"</span>)</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>dend <span class="ot">&lt;-</span>  <span class="fu">as.dendrogram</span>(hc) <span class="sc">%&gt;%</span></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>   <span class="fu">set</span>(<span class="st">"branches_lwd"</span>, <span class="dv">1</span>) <span class="sc">%&gt;%</span> <span class="co"># Branches line width</span></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>   <span class="fu">set</span>(<span class="st">"branches_k_color"</span>, mycols, <span class="at">k =</span> <span class="dv">3</span>) <span class="sc">%&gt;%</span> <span class="co"># Color branches by groups</span></span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>   <span class="fu">set</span>(<span class="st">"labels_colors"</span>, mycols, <span class="at">k =</span> <span class="dv">3</span>) <span class="sc">%&gt;%</span>  <span class="co"># Color labels by groups</span></span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>   <span class="fu">set</span>(<span class="st">"labels_cex"</span>, <span class="fl">0.5</span>) <span class="co"># Change label size</span></span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. Create plot </span></span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_dend</span>(dend) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: `guides(&lt;scale&gt; = FALSE)` is deprecated. Please use `guides(&lt;scale&gt; =
"none")` instead.</code></pre>
</div>
<div class="cell-output-display">
<p><img src="Primerv7_to_R_code_files/figure-html/unnamed-chunk-22-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="day-2" class="level2">
<h2 class="anchored" data-anchor-id="day-2">Day 2</h2>
</section>
<section id="multi-dimensional-scaling" class="level1">
<h1>Multi-dimensional scaling</h1>
</section>
<section id="relate-test-mantel-test-in-r" class="level1">
<h1>RELATE test == Mantel Test in R</h1>
</section>
<section id="dispersion" class="level1">
<h1>dispersion</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co"># nmds , 100 iterations, bray curtis distance</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>orders <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"E:/1 Master's/MSU/course classes/Fall 2022/WFA 7000 FALL2022/materials/Primerv7 to R code/condensed_order.csv"</span>, <span class="at">header =</span> <span class="cn">TRUE</span>)</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(orders)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  siteID  namedLocation         collectDate Amphipoda Coleoptera Diptera
1   ARIK ARIK.AOS.reach 2014-07-14 17:51:00         0         42     210
2   ARIK ARIK.AOS.reach 2014-09-29 18:20:00         0          5      54
3   ARIK ARIK.AOS.reach 2015-03-25 17:15:00         0          7     336
4   ARIK ARIK.AOS.reach 2015-07-14 14:55:00         0         14      80
5   ARIK ARIK.AOS.reach 2016-03-31 15:41:00         0          2     210
6   ARIK ARIK.AOS.reach 2016-07-13 15:24:00         0         43     647
  Ephemeroptera Hemiptera Trichoptera Trombidiformes Tubificida decimalLatitude
1            27        27           0              6         20        39.75821
2             9         2           0              1          0        39.75821
3             2         1          11             59         13        39.75821
4             1         1           0              1          1        39.75821
5             0         0           4              4         34        39.75821
6            38         3           1             16         77        39.75821
  decimalLongitude aquaticSiteType elevation
1        -102.4471          stream    1179.5
2        -102.4471          stream    1179.5
3        -102.4471          stream    1179.5
4        -102.4471          stream    1179.5
5        -102.4471          stream    1179.5
6        -102.4471          stream    1179.5</code></pre>
</div>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co"># print</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">dim</span>(orders))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 303  15</code></pre>
</div>
</div>
<section id="day-2-1" class="level2">
<h2 class="anchored" data-anchor-id="day-2-1">Day 2</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>nmds_results<span class="ot">&lt;-</span> <span class="fu">metaMDS</span>(orders[ , <span class="dv">4</span><span class="sc">:</span><span class="dv">11</span>],  <span class="co"># Define the community data</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>                        <span class="at">distance =</span> <span class="st">"bray"</span>,       <span class="co"># Specify a bray-curtis distance</span></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>                        <span class="at">try =</span> <span class="dv">100</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Square root transformation
Wisconsin double standardization
Run 0 stress 0.177015 
Run 1 stress 0.1770698 
... Procrustes: rmse 0.007303209  max resid 0.1234263 
Run 2 stress 0.1819268 
Run 3 stress 0.1757 
... New best solution
... Procrustes: rmse 0.01317969  max resid 0.1268593 
Run 4 stress 0.1897095 
Run 5 stress 0.2182871 
Run 6 stress 0.1782065 
Run 7 stress 0.1846039 
Run 8 stress 0.1999445 
Run 9 stress 0.1757 
... New best solution
... Procrustes: rmse 4.164228e-05  max resid 0.0005607043 
... Similar to previous best
Run 10 stress 0.2185857 
Run 11 stress 0.185824 
Run 12 stress 0.1756999 
... New best solution
... Procrustes: rmse 3.413699e-05  max resid 0.0004332832 
... Similar to previous best
Run 13 stress 0.177362 
Run 14 stress 0.1772394 
Run 15 stress 0.1786806 
Run 16 stress 0.1770036 
Run 17 stress 0.2043276 
Run 18 stress 0.2091768 
Run 19 stress 0.1860592 
Run 20 stress 0.179339 
*** Solution reached</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(nmds_results,<span class="st">'site'</span>)</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a><span class="fu">orditorp</span>(nmds_results,<span class="st">'site'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Primerv7_to_R_code_files/figure-html/unnamed-chunk-28-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="co"># NMDS1 and NMDS2</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>data_scores<span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">scores</span>(nmds_results,<span class="at">display=</span><span class="st">'site'</span>))</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Now add the extra aquaticSiteType column</span></span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>data_scores <span class="ot">&lt;-</span> <span class="fu">cbind</span>(data_scores, orders[, <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">14</span>)])</span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(data_scores)[<span class="dv">3</span>] <span class="ot">&lt;-</span> <span class="st">"siteid"</span></span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(data_scores)[<span class="dv">4</span>] <span class="ot">&lt;-</span> <span class="st">"aquaticSiteType"</span></span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(data_scores)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        NMDS1       NMDS2 siteid aquaticSiteType
1 -0.05716326 -0.26463575   ARIK          stream
2  0.40962955 -0.19918376   ARIK          stream
3  0.12359667 -0.08074464   ARIK          stream
4  0.40027922  0.04000929   ARIK          stream
5  0.13558713  0.24622679   ARIK          stream
6  0.12448388 -0.02181380   ARIK          stream</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Next, we can add the scores for species data</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>species_scores <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">scores</span>(nmds_results, <span class="st">"species"</span>))</span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Add a column equivalent to the row name to create species labels</span></span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>species_scores<span class="sc">$</span>species <span class="ot">&lt;-</span> <span class="fu">rownames</span>(species_scores)</span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(species_scores)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                   NMDS1      NMDS2       species
Amphipoda     -1.1536167  0.3436050     Amphipoda
Coleoptera     0.3308556 -0.6268615    Coleoptera
Diptera        0.2769615  0.3948023       Diptera
Ephemeroptera  0.3247482 -0.4309029 Ephemeroptera
Hemiptera     -1.1870404 -0.5393398     Hemiptera
Trichoptera    0.2636111 -0.4464375   Trichoptera</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(viridis)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: viridisLite</code></pre>
</div>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">data =</span> species_scores, <span class="fu">aes</span>(<span class="at">x =</span> NMDS1, <span class="at">y =</span> NMDS2, <span class="at">label =</span> species),</span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>            <span class="at">alpha =</span> <span class="fl">0.5</span>, <span class="at">size =</span> <span class="dv">10</span>) <span class="sc">+</span></span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> data_scores, <span class="fu">aes</span>(<span class="at">x =</span> NMDS1, <span class="at">y =</span> NMDS2,</span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">color =</span> aquaticSiteType), <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">inferno</span>(<span class="dv">15</span>)[<span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">8</span>, <span class="dv">11</span>)],</span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a>                     <span class="at">name =</span> <span class="st">"Aquatic System Type"</span>) <span class="sc">+</span></span>
<span id="cb44-8"><a href="#cb44-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">"label"</span>, <span class="at">x =</span> <span class="sc">-</span><span class="dv">1</span>, <span class="at">y =</span> <span class="fl">1.25</span>, <span class="at">size =</span> <span class="dv">10</span>,</span>
<span id="cb44-9"><a href="#cb44-9" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="fu">paste</span>(<span class="st">"Stress: "</span>, <span class="fu">round</span>(nmds_results<span class="sc">$</span>stress, <span class="at">digits =</span> <span class="dv">3</span>))) <span class="sc">+</span></span>
<span id="cb44-10"><a href="#cb44-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Primerv7_to_R_code_files/figure-html/unnamed-chunk-34-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>data_scores, <span class="fu">aes</span>(<span class="at">x =</span> NMDS1, <span class="at">y =</span> NMDS2)) <span class="sc">+</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a> <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">shape=</span> aquaticSiteType,<span class="at">color=</span>siteid)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Primerv7_to_R_code_files/figure-html/unnamed-chunk-36-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">

</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>orders <span class="sc">%&gt;%</span> </span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="dv">4</span><span class="sc">:</span><span class="dv">11</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">'richness'</span><span class="ot">=</span><span class="fu">rowSums</span>(.)) <span class="sc">%&gt;%</span> </span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(richness) <span class="sc">%&gt;%</span> </span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cbind</span>(data_scores) <span class="sc">%&gt;%</span> </span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> NMDS1, <span class="at">y =</span> NMDS2)) <span class="sc">+</span></span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">size =</span> richness, <span class="at">color =</span> aquaticSiteType)) <span class="sc">+</span></span>
<span id="cb46-8"><a href="#cb46-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_ellipse</span>(<span class="at">geom =</span> <span class="st">"polygon"</span>, <span class="fu">aes</span>(<span class="at">group =</span>aquaticSiteType, <span class="at">color =</span> aquaticSiteType, <span class="at">fill =</span> aquaticSiteType), <span class="at">alpha =</span> <span class="fl">0.3</span>)<span class="sc">+</span></span>
<span id="cb46-9"><a href="#cb46-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">"label"</span>, <span class="at">x =</span> <span class="sc">-</span><span class="dv">1</span>, <span class="at">y =</span> <span class="fl">1.25</span>, <span class="at">size =</span> <span class="dv">5</span>,</span>
<span id="cb46-10"><a href="#cb46-10" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="fu">paste</span>(<span class="st">"Stress: "</span>, <span class="fu">round</span>(nmds_results<span class="sc">$</span>stress, <span class="at">digits =</span> <span class="dv">3</span>))) <span class="sc">+</span></span>
<span id="cb46-11"><a href="#cb46-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Primerv7_to_R_code_files/figure-html/unnamed-chunk-40-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>data_scores<span class="sc">$</span>site<span class="ot">&lt;-</span> ekofish<span class="sc">$</span>site</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Unknown or uninitialised column: `site`.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(data_scores)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        NMDS1       NMDS2 siteid aquaticSiteType
1 -0.05716326 -0.26463575   ARIK          stream
2  0.40962955 -0.19918376   ARIK          stream
3  0.12359667 -0.08074464   ARIK          stream
4  0.40027922  0.04000929   ARIK          stream
5  0.13558713  0.24622679   ARIK          stream
6  0.12448388 -0.02181380   ARIK          stream</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>species_scores<span class="ot">&lt;-</span><span class="fu">as.data.frame</span>(<span class="fu">scores</span>(nmds_results, <span class="st">"species"</span>))</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(species_scores)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                   NMDS1      NMDS2
Amphipoda     -1.1536167  0.3436050
Coleoptera     0.3308556 -0.6268615
Diptera        0.2769615  0.3948023
Ephemeroptera  0.3247482 -0.4309029
Hemiptera     -1.1870404 -0.5393398
Trichoptera    0.2636111 -0.4464375</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>scrs<span class="ot">=</span><span class="fu">scores</span>(nmds_results,<span class="at">display =</span> <span class="st">"sites"</span>, <span class="st">"species"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>colvec <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"gray0"</span>, <span class="st">"gray0"</span>, <span class="st">"gray49"</span>, <span class="st">"gray49"</span>)   <span class="co"># Identifies colors for group assignments</span></span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>pchvec <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">21</span>, <span class="dv">21</span>, <span class="dv">22</span>, <span class="dv">22</span>)   <span class="co"># Identifies character symbols for group assignments</span></span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(nmds_results)</span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a><span class="fu">with</span>(orders,<span class="fu">points</span>(nmds_results,<span class="at">display =</span> <span class="st">"sites"</span>,</span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">col =</span> <span class="st">"black"</span>,<span class="at">pch =</span> pchvec[aquaticSiteType],</span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">bg =</span> colvec[aquaticSiteType]))</span>
<span id="cb54-7"><a href="#cb54-7" aria-hidden="true" tabindex="-1"></a><span class="fu">ordihull</span>(nmds_results,orders<span class="sc">$</span>aquaticSiteType,<span class="at">display =</span> <span class="st">"sites"</span>,</span>
<span id="cb54-8"><a href="#cb54-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">draw =</span> <span class="fu">c</span>(<span class="st">"polygon"</span>),</span>
<span id="cb54-9"><a href="#cb54-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">col =</span> <span class="cn">NULL</span>,</span>
<span id="cb54-10"><a href="#cb54-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">border =</span> <span class="fu">c</span>(<span class="st">"gray0"</span>, <span class="st">"gray0"</span>, <span class="st">"gray48"</span>, <span class="st">"gray48"</span>),</span>
<span id="cb54-11"><a href="#cb54-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">lty =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">2</span>),</span>
<span id="cb54-12"><a href="#cb54-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">lwd =</span> <span class="fl">2.5</span>)</span>
<span id="cb54-13"><a href="#cb54-13" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(scrs,</span>
<span id="cb54-14"><a href="#cb54-14" aria-hidden="true" tabindex="-1"></a>     <span class="at">pch =</span> <span class="fu">c</span>( <span class="dv">8</span> , <span class="dv">8</span> , <span class="dv">8</span>, <span class="dv">8</span>),</span>
<span id="cb54-15"><a href="#cb54-15" aria-hidden="true" tabindex="-1"></a>       <span class="at">col =</span> <span class="fu">c</span>(<span class="st">"gray0"</span>, <span class="st">"gray0"</span>, <span class="st">"gray48"</span>, <span class="st">"gray48"</span>),</span>
<span id="cb54-16"><a href="#cb54-16" aria-hidden="true" tabindex="-1"></a>       <span class="at">bg =</span> <span class="fu">c</span>(<span class="st">"black"</span>),</span>
<span id="cb54-17"><a href="#cb54-17" aria-hidden="true" tabindex="-1"></a>      <span class="at">lwd =</span> <span class="fl">3.0</span>,</span>
<span id="cb54-18"><a href="#cb54-18" aria-hidden="true" tabindex="-1"></a>      <span class="at">cex =</span> <span class="fl">2.0</span> <span class="co"># Plots centroids as points on ordination</span></span>
<span id="cb54-19"><a href="#cb54-19" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Primerv7_to_R_code_files/figure-html/unnamed-chunk-48-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>treat<span class="ot">=</span><span class="fu">c</span>(<span class="fu">rep</span>(<span class="st">"stream"</span>,<span class="dv">125</span>),<span class="fu">rep</span>(<span class="st">"lake"</span>,<span class="dv">178</span>))</span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ordiplot</span>(nmds_results,<span class="at">type=</span><span class="st">"n"</span>)</span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ordihull</span>(nmds_results,<span class="at">groups=</span>treat,<span class="at">draw=</span><span class="st">"polygon"</span>,<span class="at">col=</span><span class="fu">c</span>(<span class="st">"grey90"</span>,<span class="st">'red'</span>),<span class="at">label=</span>F)</span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a><span class="fu">orditorp</span>(nmds_results,<span class="at">display=</span><span class="st">"species"</span>,<span class="at">col=</span><span class="st">"red"</span>,<span class="at">air=</span><span class="fl">0.01</span>)</span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a><span class="fu">orditorp</span>(nmds_results,<span class="at">display=</span><span class="st">"sites"</span>,<span class="at">col=</span><span class="fu">c</span>(<span class="fu">rep</span>(<span class="st">"green"</span>,<span class="dv">5</span>),<span class="fu">rep</span>(<span class="st">"blue"</span>,<span class="dv">5</span>)),</span>
<span id="cb55-6"><a href="#cb55-6" aria-hidden="true" tabindex="-1"></a>   <span class="at">air=</span><span class="fl">0.01</span>,<span class="at">cex=</span><span class="fl">1.25</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Primerv7_to_R_code_files/figure-html/unnamed-chunk-50-1.png" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">Shapard plot</figcaption><p></p>
</figure>
</div>
</div>
</div>
<div class="cell">

</div>
</section>
<section id="day-3" class="level2">
<h2 class="anchored" data-anchor-id="day-3">Day 3</h2>
</section>
</section>
<section id="anosim--analysis-of-similarity-it-is-distribution-free.-it-only-used-rank-similarities-like-nmds." class="level1">
<h1>Anosim- Analysis of Similarity: it is distribution free. It only used rank similarities like nMDS.</h1>
</section>
<section id="bootstrap-region-estimation" class="level1">
<h1>bootstrap region estimation</h1>
</section>
<section id="best-anova-analysis" class="level1">
<h1>BEST ANOVA ANALYSIS</h1>
</section>
<section id="linkage-tree-analysis" class="level1">
<h1>Linkage tree analysis</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(dune)</span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(dune.env)</span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(dune)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Achimill Agrostol Airaprae Alopgeni Anthodor Bellpere Bromhord Chenalbu
1        1        0        0        0        0        0        0        0
2        3        0        0        2        0        3        4        0
3        0        4        0        7        0        2        0        0
4        0        8        0        2        0        2        3        0
5        2        0        0        0        4        2        2        0
6        2        0        0        0        3        0        0        0
  Cirsarve Comapalu Eleopalu Elymrepe Empenigr Hyporadi Juncarti Juncbufo
1        0        0        0        4        0        0        0        0
2        0        0        0        4        0        0        0        0
3        0        0        0        4        0        0        0        0
4        2        0        0        4        0        0        0        0
5        0        0        0        4        0        0        0        0
6        0        0        0        0        0        0        0        0
  Lolipere Planlanc Poaprat Poatriv Ranuflam Rumeacet Sagiproc Salirepe
1        7        0       4       2        0        0        0        0
2        5        0       4       7        0        0        0        0
3        6        0       5       6        0        0        0        0
4        5        0       4       5        0        0        5        0
5        2        5       2       6        0        5        0        0
6        6        5       3       4        0        6        0        0
  Scorautu Trifprat Trifrepe Vicilath Bracruta Callcusp
1        0        0        0        0        0        0
2        5        0        5        0        0        0
3        2        0        2        0        2        0
4        2        0        1        0        2        0
5        3        2        2        0        2        0
6        3        5        5        0        6        0</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>m_com<span class="ot">=</span><span class="fu">as.matrix</span>(dune)</span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>ano<span class="ot">=</span><span class="fu">anosim</span>(m_com,dune.env<span class="sc">$</span>Management,<span class="at">distance =</span> <span class="st">'bray'</span>,<span class="at">permutations =</span> <span class="dv">9999</span>)</span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>ano</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
anosim(x = m_com, grouping = dune.env$Management, permutations = 9999,      distance = "bray") 
Dissimilarity: bray 

ANOSIM statistic R: 0.2579 
      Significance: 0.0093 

Permutation: free
Number of permutations: 9999</code></pre>
</div>
</div>
<p>Significance value less than 0.05 statistically significant, and the null hypothesis can be rejected.There is a statistically significant different in communities between groups. An R value close to 1.0 suggests dissimilarity between groups while an R value close to 0 suggests an even distribution of high and low ranks within and between groups.</p>
<div class="cell">

</div>
<section id="day-4" class="level2">
<h2 class="anchored" data-anchor-id="day-4">Day 4</h2>
</section>
</section>
<section id="simper" class="level1">
<h1>SIMPER</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(dune) <span class="co"># biotic data</span></span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(dune.env) <span class="co"># environmental data</span></span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Management is the sort species name</span></span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a>(sim <span class="ot">&lt;-</span> <span class="fu">with</span>(dune.env, <span class="fu">simper</span>(dune, Management, <span class="at">permutations =</span> <span class="dv">99</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>cumulative contributions of most influential species:

$SF_BF
  Agrostol   Alopgeni   Lolipere   Trifrepe    Poatriv   Scorautu   Bromhord 
0.09824271 0.18254830 0.25956958 0.33367870 0.40734444 0.47729205 0.53120026 
  Achimill   Planlanc   Elymrepe   Bracruta 
0.57946526 0.62522255 0.67016196 0.71098133 

$SF_HF
  Agrostol   Alopgeni   Lolipere   Planlanc   Rumeacet   Elymrepe    Poatriv 
0.08350879 0.16534834 0.23934930 0.30843624 0.37716139 0.43334492 0.48351753 
  Bracruta   Eleopalu    Poaprat   Anthodor   Sagiproc   Trifprat 
0.52804045 0.57205850 0.61423981 0.65549838 0.69628951 0.73696831 

$SF_NM
  Poatriv  Alopgeni  Agrostol  Lolipere  Eleopalu   Poaprat  Bracruta  Elymrepe 
0.1013601 0.1935731 0.2667383 0.3377578 0.3999419 0.4526707 0.5044725 0.5505643 
 Scorautu  Trifrepe  Sagiproc  Salirepe 
0.5926117 0.6320111 0.6712478 0.7091528 

$BF_HF
  Rumeacet    Poatriv   Planlanc   Bromhord   Lolipere   Elymrepe   Trifrepe 
0.08163219 0.15193797 0.21918333 0.27967181 0.33969561 0.39843338 0.45298204 
  Anthodor   Achimill   Bracruta   Alopgeni   Trifprat   Juncarti 
0.50276849 0.55222648 0.60021994 0.64584333 0.69126471 0.73366621 

$BF_NM
 Lolipere   Poatriv   Poaprat  Trifrepe  Bromhord  Bracruta  Eleopalu  Agrostol 
0.1242718 0.1992126 0.2711756 0.3414609 0.3958520 0.4448077 0.4910724 0.5369083 
 Achimill  Scorautu  Anthodor  Planlanc 
0.5823926 0.6253645 0.6638182 0.7012577 

$HF_NM
   Poatriv   Lolipere   Rumeacet    Poaprat   Planlanc   Bracruta   Eleopalu 
0.09913221 0.17468460 0.23917190 0.29701331 0.35469313 0.40365488 0.44804851 
  Agrostol   Trifrepe   Elymrepe   Anthodor   Juncarti   Trifprat   Salirepe 
0.49226546 0.53434466 0.57564661 0.61543243 0.65341300 0.68921695 0.72432408 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(sim)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Contrast: SF_BF 

         average      sd   ratio     ava     avb cumsum    p  
Agrostol 0.06137 0.03419 1.79490 4.66700 0.00000  0.098 0.04 *
Alopgeni 0.05267 0.03648 1.44390 4.33300 0.66700  0.182 0.13  
Lolipere 0.04812 0.03945 1.21980 3.00000 6.00000  0.260 0.50  
Trifrepe 0.04630 0.02553 1.81380 1.33300 4.66700  0.334 0.05 *
Poatriv  0.04602 0.03380 1.36150 4.66700 3.66700  0.407 0.59  
Scorautu 0.04370 0.02492 1.75340 1.33300 4.33300  0.477 0.02 *
Bromhord 0.03368 0.02586 1.30230 0.50000 2.66700  0.531 0.02 *
Achimill 0.03015 0.02082 1.44820 0.16700 2.33300  0.580 0.02 *
Planlanc 0.02859 0.02155 1.32650 0.00000 2.00000  0.625 0.51  
Elymrepe 0.02807 0.02978 0.94280 2.00000 1.33300  0.670 0.58  
Bracruta 0.02550 0.02390 1.06690 2.00000 2.00000  0.711 0.85  
Poaprat  0.02513 0.02397 1.04850 2.50000 4.00000  0.751 0.91  
Sagiproc 0.02433 0.02215 1.09830 1.83300 0.66700  0.790 0.44  
Bellpere 0.01986 0.01709 1.16220 0.66700 1.66700  0.822 0.07 .
Eleopalu 0.01861 0.04296 0.43330 1.33300 0.00000  0.852 0.88  
Anthodor 0.01754 0.02580 0.67980 0.00000 1.33300  0.880 0.85  
Juncbufo 0.01603 0.02371 0.67620 1.16700 0.00000  0.905 0.57  
Vicilath 0.01467 0.01331 1.10260 0.00000 1.00000  0.929 0.04 *
Hyporadi 0.01029 0.01520 0.67680 0.00000 0.66700  0.945 0.74  
Ranuflam 0.00931 0.01360 0.68450 0.66700 0.00000  0.960 0.93  
Juncarti 0.00698 0.01611 0.43330 0.50000 0.00000  0.972 0.99  
Callcusp 0.00698 0.01611 0.43330 0.50000 0.00000  0.983 0.86  
Rumeacet 0.00453 0.01044 0.43330 0.33300 0.00000  0.990 0.96  
Cirsarve 0.00398 0.00918 0.43360 0.33300 0.00000  0.996 0.47  
Chenalbu 0.00233 0.00537 0.43330 0.16700 0.00000  1.000 0.41  
Airaprae 0.00000 0.00000     NaN 0.00000 0.00000  1.000 0.81  
Comapalu 0.00000 0.00000     NaN 0.00000 0.00000  1.000 0.66  
Empenigr 0.00000 0.00000     NaN 0.00000 0.00000  1.000 0.56  
Salirepe 0.00000 0.00000     NaN 0.00000 0.00000  1.000 0.92  
Trifprat 0.00000 0.00000     NaN 0.00000 0.00000  1.000 0.89  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Contrast: SF_HF 

         average      sd   ratio     ava     avb cumsum    p   
Agrostol 0.04738 0.03127 1.51510 4.66700 1.40000  0.084 0.31   
Alopgeni 0.04643 0.03290 1.41150 4.33300 1.60000  0.165 0.20   
Lolipere 0.04199 0.02701 1.55460 3.00000 4.00000  0.239 0.77   
Planlanc 0.03920 0.03321 1.18040 0.00000 3.00000  0.308 0.02 * 
Rumeacet 0.03899 0.02737 1.42470 0.33300 3.20000  0.377 0.01 **
Elymrepe 0.03188 0.02955 1.07870 2.00000 2.00000  0.433 0.36   
Poatriv  0.02847 0.02152 1.32270 4.66700 4.80000  0.484 1.00   
Bracruta 0.02526 0.02104 1.20040 2.00000 2.80000  0.528 0.93   
Eleopalu 0.02497 0.03888 0.64240 1.33300 0.80000  0.572 0.77   
Poaprat  0.02393 0.01918 1.24780 2.50000 3.40000  0.614 0.99   
Anthodor 0.02341 0.02143 1.09230 0.00000 1.80000  0.655 0.64   
Sagiproc 0.02314 0.02048 1.13010 1.83300 0.80000  0.696 0.40   
Trifprat 0.02308 0.02343 0.98500 0.00000 1.80000  0.737 0.01 **
Juncarti 0.02285 0.02568 0.88990 0.50000 1.60000  0.777 0.54   
Trifrepe 0.02238 0.01949 1.14860 1.33300 2.80000  0.817 0.99   
Juncbufo 0.02164 0.02224 0.97330 1.16700 1.20000  0.855 0.22   
Scorautu 0.02051 0.01642 1.24890 1.33300 2.80000  0.891 0.83   
Achimill 0.01518 0.01139 1.33260 0.16700 1.20000  0.918 0.68   
Bromhord 0.01338 0.01450 0.92220 0.50000 0.80000  0.941 0.73   
Ranuflam 0.01066 0.01339 0.79640 0.66700 0.40000  0.960 0.86   
Bellpere 0.00999 0.01257 0.79480 0.66700 0.40000  0.978 0.87   
Callcusp 0.00662 0.01508 0.43930 0.50000 0.00000  0.989 0.95   
Cirsarve 0.00381 0.00867 0.43940 0.33300 0.00000  0.996 0.52   
Chenalbu 0.00221 0.00503 0.43930 0.16700 0.00000  1.000 0.53   
Airaprae 0.00000 0.00000     NaN 0.00000 0.00000  1.000 0.82   
Comapalu 0.00000 0.00000     NaN 0.00000 0.00000  1.000 0.87   
Empenigr 0.00000 0.00000     NaN 0.00000 0.00000  1.000 0.54   
Hyporadi 0.00000 0.00000     NaN 0.00000 0.00000  1.000 0.92   
Salirepe 0.00000 0.00000     NaN 0.00000 0.00000  1.000 0.90   
Vicilath 0.00000 0.00000     NaN 0.00000 0.00000  1.000 0.87   
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Contrast: SF_NM 

         average      sd   ratio     ava     avb cumsum    p   
Poatriv  0.07828 0.04095 1.91180 4.66700 0.00000  0.101 0.01 **
Alopgeni 0.07122 0.04696 1.51670 4.33300 0.00000  0.194 0.01 **
Agrostol 0.05651 0.04418 1.27920 4.66700 2.16700  0.267 0.05 * 
Lolipere 0.05485 0.05991 0.91550 3.00000 0.33300  0.338 0.23   
Eleopalu 0.04803 0.04717 1.01820 1.33300 2.16700  0.400 0.04 * 
Poaprat  0.04072 0.03179 1.28100 2.50000 0.66700  0.453 0.04 * 
Bracruta 0.04001 0.03440 1.16310 2.00000 2.83300  0.504 0.11   
Elymrepe 0.03560 0.03852 0.92430 2.00000 0.00000  0.551 0.07 . 
Scorautu 0.03247 0.03481 0.93280 1.33300 3.16700  0.593 0.10 . 
Trifrepe 0.03043 0.03163 0.96190 1.33300 1.83300  0.632 0.65   
Sagiproc 0.03030 0.03048 0.99430 1.83300 0.50000  0.671 0.05 * 
Salirepe 0.02928 0.03201 0.91440 0.00000 1.83300  0.709 0.02 * 
Anthodor 0.02454 0.03669 0.66880 0.00000 1.33300  0.741 0.52   
Callcusp 0.02276 0.02944 0.77310 0.50000 1.16700  0.770 0.08 . 
Ranuflam 0.02257 0.02282 0.98890 0.66700 1.33300  0.800 0.09 . 
Juncarti 0.02254 0.02860 0.78830 0.50000 1.16700  0.829 0.49   
Hyporadi 0.02011 0.03129 0.64260 0.00000 1.16700  0.855 0.18   
Juncbufo 0.01986 0.02903 0.68400 1.16700 0.00000  0.881 0.31   
Planlanc 0.01542 0.02277 0.67720 0.00000 0.83300  0.900 0.99   
Airaprae 0.01488 0.02188 0.68020 0.00000 0.83300  0.920 0.07 . 
Bellpere 0.01232 0.01592 0.77370 0.66700 0.33300  0.936 0.66   
Comapalu 0.01188 0.01741 0.68260 0.00000 0.66700  0.951 0.08 . 
Achimill 0.00929 0.01493 0.62240 0.16700 0.33300  0.963 1.00   
Bromhord 0.00717 0.01633 0.43910 0.50000 0.00000  0.972 0.95   
Rumeacet 0.00559 0.01275 0.43840 0.33300 0.00000  0.980 0.99   
Empenigr 0.00523 0.01200 0.43540 0.00000 0.33300  0.986 0.28   
Cirsarve 0.00478 0.01089 0.43910 0.33300 0.00000  0.993 0.01 **
Chenalbu 0.00289 0.00660 0.43820 0.16700 0.00000  0.996 0.02 * 
Vicilath 0.00279 0.00642 0.43450 0.00000 0.16700  1.000 0.79   
Trifprat 0.00000 0.00000     NaN 0.00000 0.00000  1.000 0.99   
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Contrast: BF_HF 

         average      sd   ratio     ava     avb cumsum    p  
Rumeacet 0.03867 0.02606 1.48380 0.00000 3.20000  0.082 0.03 *
Poatriv  0.03330 0.02579 1.29110 3.66700 4.80000  0.152 0.95  
Planlanc 0.03185 0.01830 1.74010 2.00000 3.00000  0.219 0.34  
Bromhord 0.02865 0.01799 1.59260 2.66700 0.80000  0.280 0.06 .
Lolipere 0.02843 0.02215 1.28340 6.00000 4.00000  0.340 0.95  
Elymrepe 0.02782 0.02959 0.94040 1.33300 2.00000  0.398 0.55  
Trifrepe 0.02584 0.01656 1.56030 4.66700 2.80000  0.453 0.76  
Anthodor 0.02358 0.02042 1.15470 1.33300 1.80000  0.503 0.57  
Achimill 0.02343 0.01474 1.58930 2.33300 1.20000  0.552 0.15  
Bracruta 0.02273 0.01802 1.26170 2.00000 2.80000  0.600 0.86  
Alopgeni 0.02161 0.02308 0.93630 0.66700 1.60000  0.646 0.83  
Trifprat 0.02151 0.02207 0.97470 0.00000 1.80000  0.691 0.09 .
Juncarti 0.02008 0.02555 0.78600 0.00000 1.60000  0.734 0.69  
Scorautu 0.01932 0.01357 1.42410 4.33300 2.80000  0.774 0.76  
Bellpere 0.01829 0.01486 1.23050 1.66700 0.40000  0.813 0.23  
Agrostol 0.01761 0.02284 0.77080 0.00000 1.40000  0.850 1.00  
Juncbufo 0.01500 0.02066 0.72600 0.00000 1.20000  0.882 0.58  
Vicilath 0.01285 0.01140 1.12740 1.00000 0.00000  0.909 0.07 .
Sagiproc 0.01168 0.01297 0.90080 0.66700 0.80000  0.934 0.89  
Eleopalu 0.01017 0.02111 0.48170 0.00000 0.80000  0.955 0.94  
Hyporadi 0.00895 0.01312 0.68240 0.66700 0.00000  0.974 0.65  
Poaprat  0.00720 0.01010 0.71330 4.00000 3.40000  0.989 1.00  
Ranuflam 0.00508 0.01055 0.48170 0.00000 0.40000  1.000 0.95  
Airaprae 0.00000 0.00000     NaN 0.00000 0.00000  1.000 0.61  
Chenalbu 0.00000 0.00000     NaN 0.00000 0.00000  1.000 0.36  
Cirsarve 0.00000 0.00000     NaN 0.00000 0.00000  1.000 0.46  
Comapalu 0.00000 0.00000     NaN 0.00000 0.00000  1.000 0.66  
Empenigr 0.00000 0.00000     NaN 0.00000 0.00000  1.000 0.42  
Salirepe 0.00000 0.00000     NaN 0.00000 0.00000  1.000 0.83  
Callcusp 0.00000 0.00000     NaN 0.00000 0.00000  1.000 0.78  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Contrast: BF_NM 

         average      sd   ratio     ava     avb cumsum    p   
Lolipere 0.09068 0.02644 3.42900 6.00000 0.33300  0.124 0.01 **
Poatriv  0.05468 0.04465 1.22500 3.66700 0.00000  0.199 0.30   
Poaprat  0.05251 0.01813 2.89700 4.00000 0.66700  0.271 0.01 **
Trifrepe 0.05129 0.02756 1.86100 4.66700 1.83300  0.342 0.05 * 
Bromhord 0.03969 0.02920 1.35900 2.66700 0.00000  0.396 0.02 * 
Bracruta 0.03572 0.02869 1.24500 2.00000 2.83300  0.445 0.36   
Eleopalu 0.03376 0.03573 0.94500 0.00000 2.16700  0.491 0.48   
Agrostol 0.03345 0.03473 0.96300 0.00000 2.16700  0.537 0.86   
Achimill 0.03319 0.02338 1.42000 2.33300 0.33300  0.582 0.03 * 
Scorautu 0.03136 0.02026 1.54800 4.33300 3.16700  0.625 0.27   
Anthodor 0.02806 0.03295 0.85200 1.33300 1.33300  0.664 0.36   
Planlanc 0.02732 0.02193 1.24600 2.00000 0.83300  0.701 0.54   
Salirepe 0.02677 0.02927 0.91400 0.00000 1.83300  0.738 0.12   
Bellpere 0.02353 0.01909 1.23200 1.66700 0.33300  0.770 0.01 **
Hyporadi 0.02172 0.02450 0.88600 0.66700 1.16700  0.800 0.22   
Ranuflam 0.02031 0.02275 0.89300 0.00000 1.33300  0.828 0.25   
Elymrepe 0.01999 0.02926 0.68300 1.33300 0.00000  0.855 0.87   
Callcusp 0.01783 0.02681 0.66500 0.00000 1.16700  0.880 0.36   
Juncarti 0.01769 0.02600 0.68100 0.00000 1.16700  0.904 0.74   
Vicilath 0.01577 0.01447 1.09000 1.00000 0.16700  0.925 0.01 **
Sagiproc 0.01543 0.01857 0.83100 0.66700 0.50000  0.947 0.79   
Airaprae 0.01341 0.01969 0.68100 0.00000 0.83300  0.965 0.24   
Comapalu 0.01074 0.01571 0.68400 0.00000 0.66700  0.980 0.36   
Alopgeni 0.01000 0.01463 0.68300 0.66700 0.00000  0.993 0.99   
Empenigr 0.00479 0.01105 0.43300 0.00000 0.33300  1.000 0.32   
Chenalbu 0.00000 0.00000     NaN 0.00000 0.00000  1.000 0.49   
Cirsarve 0.00000 0.00000     NaN 0.00000 0.00000  1.000 0.44   
Juncbufo 0.00000 0.00000     NaN 0.00000 0.00000  1.000 0.96   
Rumeacet 0.00000 0.00000     NaN 0.00000 0.00000  1.000 0.99   
Trifprat 0.00000 0.00000     NaN 0.00000 0.00000  1.000 0.90   
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Contrast: HF_NM 

         average      sd   ratio     ava     avb cumsum    p   
Poatriv  0.07155 0.01368 5.23000 4.80000 0.00000  0.099 0.04 * 
Lolipere 0.05453 0.02962 1.84100 4.00000 0.33300  0.175 0.13   
Rumeacet 0.04655 0.03081 1.51100 3.20000 0.00000  0.239 0.01 **
Poaprat  0.04175 0.01885 2.21500 3.40000 0.66700  0.297 0.02 * 
Planlanc 0.04163 0.02956 1.40800 3.00000 0.83300  0.355 0.02 * 
Bracruta 0.03534 0.02010 1.75800 2.80000 2.83300  0.404 0.39   
Eleopalu 0.03204 0.03231 0.99200 0.80000 2.16700  0.448 0.53   
Agrostol 0.03192 0.02889 1.10500 1.40000 2.16700  0.492 0.96   
Trifrepe 0.03037 0.02287 1.32800 2.80000 1.83300  0.534 0.63   
Elymrepe 0.02981 0.03868 0.77100 2.00000 0.00000  0.576 0.47   
Anthodor 0.02872 0.02480 1.15800 1.80000 1.33300  0.615 0.26   
Juncarti 0.02741 0.02854 0.96100 1.60000 1.16700  0.653 0.15   
Trifprat 0.02584 0.02597 0.99500 1.80000 0.00000  0.689 0.01 **
Salirepe 0.02534 0.02729 0.92900 0.00000 1.83300  0.724 0.16   
Alopgeni 0.02446 0.03240 0.75500 1.60000 0.00000  0.758 0.89   
Scorautu 0.02070 0.01412 1.46600 2.80000 3.16700  0.787 0.84   
Ranuflam 0.01928 0.01994 0.96700 0.40000 1.33300  0.814 0.26   
Juncbufo 0.01818 0.02465 0.73800 1.20000 0.00000  0.839 0.37   
Hyporadi 0.01714 0.02655 0.64600 0.00000 1.16700  0.863 0.43   
Callcusp 0.01683 0.02490 0.67600 0.00000 1.16700  0.886 0.45   
Achimill 0.01656 0.01490 1.11100 1.20000 0.33300  0.909 0.69   
Sagiproc 0.01528 0.01653 0.92400 0.80000 0.50000  0.930 0.91   
Airaprae 0.01261 0.01824 0.69100 0.00000 0.83300  0.947 0.33   
Bromhord 0.01209 0.01517 0.79700 0.80000 0.00000  0.964 0.82   
Comapalu 0.01011 0.01456 0.69400 0.00000 0.66700  0.978 0.18   
Bellpere 0.00880 0.01373 0.64100 0.40000 0.33300  0.990 0.92   
Empenigr 0.00454 0.01033 0.43900 0.00000 0.33300  0.997 0.62   
Vicilath 0.00240 0.00546 0.43900 0.00000 0.16700  1.000 0.88   
Chenalbu 0.00000 0.00000     NaN 0.00000 0.00000  1.000 0.52   
Cirsarve 0.00000 0.00000     NaN 0.00000 0.00000  1.000 0.58   
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
Permutation: free
Number of permutations: 99</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(dune.env)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "A1"         "Moisture"   "Management" "Use"        "Manure"    </code></pre>
</div>
</div>
<div class="cell">

</div>
<div class="cell">

</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a>dune.mrpp <span class="ot">&lt;-</span> <span class="fu">with</span>(dune.env, <span class="fu">mrpp</span>(dune, Management))</span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a>dune.mrpp</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
mrpp(dat = dune, grouping = Management) 

Dissimilarity index: euclidean 
Weights for groups:  n 

Class means and counts:

      BF    HF    NM    SF   
delta 10.03 11.08 10.66 12.27
n     3     5     6     6    

Chance corrected within-group agreement A: 0.1246 
Based on observed delta 11.15 and expected delta 12.74 

Significance of delta: 0.001 
Permutation: free
Number of permutations: 999</code></pre>
</div>
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Save and change plotting parameters</span></span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a>def.par <span class="ot">&lt;-</span> <span class="fu">par</span>(<span class="at">no.readonly =</span> <span class="cn">TRUE</span>)</span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a><span class="fu">layout</span>(<span class="fu">matrix</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>,<span class="at">nr=</span><span class="dv">1</span>))</span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-5"><a href="#cb68-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(dune.ord <span class="ot">&lt;-</span> <span class="fu">metaMDS</span>(dune), <span class="at">type=</span><span class="st">"text"</span>, <span class="at">display=</span><span class="st">"sites"</span> )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Run 0 stress 0.1192678 
Run 1 stress 0.1183186 
... New best solution
... Procrustes: rmse 0.02027033  max resid 0.06496197 
Run 2 stress 0.1183186 
... Procrustes: rmse 6.734379e-06  max resid 2.265606e-05 
... Similar to previous best
Run 3 stress 0.1183186 
... Procrustes: rmse 1.301163e-05  max resid 4.048833e-05 
... Similar to previous best
Run 4 stress 0.1808911 
Run 5 stress 0.1808911 
Run 6 stress 0.1183186 
... Procrustes: rmse 3.471016e-06  max resid 7.780352e-06 
... Similar to previous best
Run 7 stress 0.1183186 
... Procrustes: rmse 5.066104e-06  max resid 1.739458e-05 
... Similar to previous best
Run 8 stress 0.1183186 
... Procrustes: rmse 2.915824e-06  max resid 7.988388e-06 
... Similar to previous best
Run 9 stress 0.1886532 
Run 10 stress 0.1183186 
... Procrustes: rmse 3.697275e-06  max resid 1.250524e-05 
... Similar to previous best
Run 11 stress 0.1192678 
Run 12 stress 0.1192678 
Run 13 stress 0.1183186 
... Procrustes: rmse 3.787357e-06  max resid 9.723932e-06 
... Similar to previous best
Run 14 stress 0.1183186 
... Procrustes: rmse 4.386282e-06  max resid 1.287277e-05 
... Similar to previous best
Run 15 stress 0.1192678 
Run 16 stress 0.1183186 
... Procrustes: rmse 1.082773e-05  max resid 3.366667e-05 
... Similar to previous best
Run 17 stress 0.1812934 
Run 18 stress 0.1192679 
Run 19 stress 0.1192678 
Run 20 stress 0.1192679 
*** Solution reached</code></pre>
</div>
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="fu">with</span>(dune.env, <span class="fu">ordihull</span>(dune.ord, Management))</span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a><span class="fu">with</span>(dune.mrpp, {</span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a>  fig.dist <span class="ot">&lt;-</span> <span class="fu">hist</span>(boot.deltas, <span class="at">xlim=</span><span class="fu">range</span>(<span class="fu">c</span>(delta,boot.deltas)), </span>
<span id="cb70-5"><a href="#cb70-5" aria-hidden="true" tabindex="-1"></a>                 <span class="at">main=</span><span class="st">"Test of Differences Among Groups"</span>)</span>
<span id="cb70-6"><a href="#cb70-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">abline</span>(<span class="at">v=</span>delta); </span>
<span id="cb70-7"><a href="#cb70-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">text</span>(delta, <span class="dv">2</span><span class="sc">*</span><span class="fu">mean</span>(fig.dist<span class="sc">$</span>counts), <span class="at">adj =</span> <span class="sc">-</span><span class="fl">0.5</span>,</span>
<span id="cb70-8"><a href="#cb70-8" aria-hidden="true" tabindex="-1"></a>     <span class="fu">expression</span>(<span class="fu">bold</span>(delta)), <span class="at">cex=</span><span class="fl">1.5</span> )  }</span>
<span id="cb70-9"><a href="#cb70-9" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Primerv7_to_R_code_files/figure-html/unnamed-chunk-68-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(def.par)</span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a><span class="do">## meandist</span></span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a>dune.md <span class="ot">&lt;-</span> <span class="fu">with</span>(dune.env, <span class="fu">meandist</span>(<span class="fu">vegdist</span>(dune), Management))</span>
<span id="cb71-4"><a href="#cb71-4" aria-hidden="true" tabindex="-1"></a>dune.md</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          BF        HF        NM        SF
BF 0.4159972 0.4736637 0.7296979 0.6247169
HF 0.4736637 0.4418115 0.7217933 0.5673664
NM 0.7296979 0.7217933 0.6882438 0.7723367
SF 0.6247169 0.5673664 0.7723367 0.5813015
attr(,"class")
[1] "meandist" "matrix"  
attr(,"n")
grouping
BF HF NM SF 
 3  5  6  6 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(dune.md)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Mean distances:
                 Average
within groups  0.5746346
between groups 0.6664172
overall        0.6456454

Summary statistics:
                        Statistic
MRPP A weights n        0.1423836
MRPP A weights n-1      0.1339124
MRPP A weights n(n-1)   0.1099842
Classification strength 0.1127012</code></pre>
</div>
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(dune.md)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Primerv7_to_R_code_files/figure-html/unnamed-chunk-68-2.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(dune.md, <span class="at">kind=</span><span class="st">"histogram"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Primerv7_to_R_code_files/figure-html/unnamed-chunk-68-3.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a>dune.mrpp<span class="sc">$</span>delta <span class="co"># The overall weighted mean of group mean distances.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 11.15359</code></pre>
</div>
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a>dune.mrpp<span class="sc">$</span>boot.deltas <span class="co"># he deltas calculated from each of the permuted datasets</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  [1] 12.37015 12.96316 13.05861 13.36131 13.29667 12.76612 12.84876 12.63856
  [9] 13.03533 13.03143 12.83146 13.15501 12.89302 12.21607 12.35865 12.87486
 [17] 13.19270 12.77778 13.10385 13.06892 12.62080 13.08536 12.14648 12.74077
 [25] 12.96120 12.93862 12.68371 12.67100 12.85122 12.08906 13.12532 12.93506
 [33] 12.77624 12.43369 11.77794 12.85484 12.82652 12.90853 12.91430 12.51058
 [41] 13.17381 12.29777 13.13295 12.53057 12.73767 13.09780 11.66643 12.61856
 [49] 12.41370 13.03392 12.47594 12.92333 13.35233 13.09567 11.95919 12.95449
 [57] 12.96237 12.24486 13.05116 12.58815 12.81075 12.58366 12.53010 12.61081
 [65] 12.51222 12.77137 13.01271 12.94666 12.77854 12.68458 12.21048 12.93922
 [73] 12.46229 12.66851 12.06708 12.71154 13.12958 12.57644 12.85866 12.90797
 [81] 13.09002 13.17050 13.31859 11.93995 12.54684 12.18135 12.83666 12.73397
 [89] 12.30607 12.07329 13.02873 12.98268 12.97230 12.56543 12.68476 12.15448
 [97] 12.79372 12.65014 12.23399 12.98806 12.58466 13.06041 11.69343 12.31086
[105] 12.79084 12.66411 12.61006 13.27479 12.44747 12.71380 13.36025 12.79321
[113] 12.98100 12.78757 13.01376 12.57450 12.19496 11.80779 13.08971 12.46423
[121] 12.10063 13.01706 12.57759 12.74854 12.70418 12.60347 13.07140 12.77175
[129] 12.81310 12.38259 12.79024 13.05614 12.52784 13.14844 12.72104 12.89868
[137] 12.94246 11.63555 12.94268 12.82824 12.49454 12.57936 12.50722 12.79781
[145] 13.06564 12.98640 12.50550 13.14983 12.54491 12.70573 12.75213 12.24105
[153] 12.56459 12.44948 13.00000 12.73642 12.56363 12.96281 13.11585 12.69388
[161] 11.88798 12.82701 11.99978 12.51369 12.88514 12.96744 12.99378 12.50310
[169] 13.24798 12.90924 11.80394 13.07924 12.57074 12.58707 12.47890 12.33973
[177] 12.89109 12.58561 12.33131 13.09024 13.09888 12.95636 12.75121 12.04439
[185] 12.86571 12.31447 12.66778 13.13593 12.94570 12.72377 12.95587 13.30013
[193] 12.68989 13.21500 13.24733 13.07173 12.91119 12.05110 13.01546 13.11067
[201] 12.68727 12.50561 12.94316 12.91232 12.73515 12.19881 13.25744 13.03329
[209] 13.16966 13.08469 12.77995 12.69694 12.77179 12.48967 12.78741 13.05518
[217] 12.80765 12.91546 11.91588 12.71432 12.31540 12.96089 12.87405 13.02272
[225] 13.00572 12.49413 12.89891 12.69281 11.94238 12.48445 13.16259 12.65746
[233] 12.21041 13.00326 13.18877 12.98946 12.42055 12.99269 13.04616 12.94766
[241] 13.03583 12.36765 12.42534 13.34033 12.93468 13.18124 12.92919 12.22865
[249] 12.67434 12.28855 12.53901 12.38040 12.92010 11.92722 12.88476 12.40910
[257] 13.08851 13.13764 12.79735 12.88055 12.74516 11.90595 12.95962 13.13411
[265] 12.87819 13.00889 13.10113 12.73101 12.44699 12.46461 12.28357 13.12210
[273] 12.93783 12.85895 12.98077 12.49547 11.98310 13.10784 11.96442 13.01879
[281] 13.06032 12.96515 13.22989 12.88945 12.58139 12.92539 12.75443 12.98152
[289] 12.52170 11.88157 12.87319 12.74240 12.79158 12.37520 13.11269 12.51082
[297] 12.42077 12.95149 12.23081 12.11527 12.71422 12.94643 13.19594 12.84476
[305] 12.63000 13.03074 12.61747 12.87797 12.65738 12.21812 12.93794 13.19620
[313] 12.32838 12.54213 12.28348 12.81412 12.38911 12.57027 13.04563 13.09337
[321] 12.53480 12.05758 13.05879 12.47642 13.17286 12.86035 12.88189 12.62303
[329] 12.69219 13.00770 12.98836 13.11071 12.84691 12.56298 12.59799 12.97199
[337] 12.81898 12.66813 12.52638 12.87851 12.85488 13.00840 13.02531 12.58150
[345] 12.03352 12.98381 13.19429 13.06416 12.62943 13.20763 12.84086 12.99751
[353] 12.42641 12.92211 12.85124 12.68782 12.77669 12.18211 12.59469 12.84494
[361] 12.87466 13.04535 12.43506 12.83015 13.04089 12.76014 12.22373 11.88614
[369] 11.88129 12.80315 12.54889 12.82628 13.00529 12.54789 12.08982 12.71317
[377] 12.95099 12.36295 13.08814 13.26269 12.71134 12.83916 13.09379 12.36923
[385] 11.98130 12.35323 12.86960 12.80471 12.91290 12.30768 12.65707 12.86814
[393] 12.84145 12.79368 12.64558 12.96373 11.99328 13.19373 12.99373 12.25713
[401] 12.04967 12.64319 12.74439 13.23365 13.03910 11.88313 13.24094 12.60593
[409] 12.77357 12.33837 12.69476 12.82563 13.17170 13.26760 12.41454 13.32122
[417] 13.18102 12.38572 12.94225 13.13670 13.09823 13.03338 12.70309 12.34464
[425] 12.99979 11.80517 12.22780 12.78863 12.26435 12.83282 13.15065 13.16086
[433] 12.57155 11.84435 12.61071 12.83617 13.06783 12.82175 13.15908 12.76611
[441] 13.08547 12.50368 12.80833 13.29691 13.14872 12.40612 12.29183 12.18267
[449] 12.69415 13.12584 13.25622 13.25375 12.24699 12.42060 12.49661 12.76554
[457] 13.16436 12.65699 13.09202 12.76259 12.63268 11.56975 12.19737 13.14656
[465] 12.64894 13.32305 12.78304 12.73044 12.90387 12.52517 13.13744 12.86660
[473] 12.39488 12.61968 12.38198 12.75309 12.94861 13.23551 12.96254 12.67793
[481] 13.04250 13.10631 12.95253 12.88049 12.75057 13.05094 12.04572 12.36431
[489] 12.67797 12.51434 12.88486 13.21360 12.18954 12.75568 12.65024 12.78911
[497] 13.19733 12.32176 13.12192 13.17628 12.85929 12.67734 12.41550 12.82572
[505] 13.18113 12.65281 12.89237 12.80509 12.47449 12.60527 12.81773 12.80360
[513] 12.95962 13.17378 12.41334 13.20161 12.97467 12.62398 12.32634 12.47497
[521] 12.06002 12.31150 13.01362 13.00320 12.58027 12.76364 13.02453 12.70858
[529] 12.59978 13.42465 12.57447 13.30462 13.07731 12.78899 12.88949 12.38395
[537] 12.64507 12.95969 12.51513 12.47675 13.15738 13.17063 12.81618 12.48635
[545] 12.76126 13.29793 12.11661 12.66466 12.91109 12.83807 12.81753 12.55814
[553] 13.01038 12.08198 12.63470 12.64104 12.19751 12.17580 12.74596 12.73444
[561] 12.92163 12.39408 12.68292 12.84337 12.39082 12.96695 12.98149 12.57233
[569] 12.83657 12.79798 12.74855 13.07235 12.37473 12.62880 13.11789 13.18723
[577] 12.82204 12.57636 12.74356 13.03346 12.68649 12.13355 12.64597 12.98850
[585] 13.01721 13.25825 12.78297 12.79039 13.03501 13.13024 12.92433 12.96757
[593] 12.95886 13.06551 13.11077 12.86828 12.13699 12.72436 12.84630 12.93641
[601] 12.80095 13.13782 13.04906 12.82340 12.68524 13.08109 12.45216 13.04682
[609] 13.20123 12.29832 12.56549 12.63507 12.32870 12.52100 12.88704 12.99524
[617] 12.93536 13.05469 12.73442 12.99503 13.05141 12.49634 13.23659 12.64106
[625] 12.69631 12.70570 13.00259 12.99207 12.98362 11.80341 12.13007 12.84851
[633] 12.78369 12.99374 12.90233 12.64253 12.68611 13.06453 12.55059 12.85771
[641] 12.99657 12.60750 12.88638 12.94425 13.05322 12.49547 13.11761 12.45511
[649] 13.17376 12.64641 12.82196 12.95747 12.56583 12.23019 12.14085 12.72116
[657] 12.90641 13.13124 13.33996 12.69317 12.75092 12.69632 12.92785 12.13417
[665] 12.51879 13.23187 13.13955 12.59837 13.28335 12.85562 12.47596 13.23023
[673] 12.96824 12.70804 13.10302 13.09467 12.93491 13.07583 12.65718 13.16713
[681] 13.11767 12.89160 12.17128 13.22985 12.66252 12.67968 13.00404 11.84809
[689] 13.30226 12.78346 12.25538 12.66783 12.94236 12.02858 12.36238 13.17528
[697] 12.67050 12.57379 12.25718 13.04220 12.10272 12.87243 13.02934 12.46903
[705] 12.55136 13.07692 12.36023 12.38864 11.89291 12.75394 12.49794 12.61318
[713] 12.56856 13.18120 12.39673 13.23128 12.43487 12.84391 13.14370 12.87405
[721] 12.14676 12.77348 13.16138 12.64352 12.71043 12.59368 12.88552 13.28107
[729] 12.72936 13.06477 12.66934 13.03435 12.98929 11.77156 12.56691 12.71101
[737] 13.05368 12.58518 12.95072 13.07479 12.67663 12.82427 12.44761 12.60071
[745] 12.90080 12.35247 12.98076 12.80266 12.96513 12.52017 12.66612 12.54556
[753] 12.65498 12.49254 12.28475 12.86843 13.29165 12.95802 12.58828 12.77691
[761] 12.66944 13.02155 12.87580 12.11816 12.89405 12.71946 13.19804 12.52521
[769] 12.94317 12.32093 12.43324 12.61819 12.21778 12.51255 12.80089 12.83586
[777] 12.86266 12.12709 12.91195 13.10465 12.60504 12.42616 12.39978 13.15418
[785] 13.24917 13.02523 12.46212 13.33282 12.50043 12.87599 12.30312 12.95296
[793] 13.01243 13.16396 12.63223 12.98377 12.92710 12.98552 12.62690 13.01924
[801] 12.26868 13.10715 13.34327 13.02825 12.74068 12.84891 13.20602 12.63259
[809] 12.27592 13.07084 12.98927 13.18157 13.14009 13.32513 12.71122 12.47250
[817] 12.74300 12.92480 13.06351 12.71009 12.80934 12.87233 13.18563 12.72434
[825] 12.64861 12.98685 12.50391 12.47416 13.24878 12.78160 13.10521 12.77876
[833] 12.69139 13.00907 12.39839 12.79188 13.05467 12.86397 13.09904 13.11735
[841] 12.53440 12.76052 13.04439 13.03580 13.04886 12.99282 13.06775 12.92076
[849] 13.03339 12.52792 12.80483 12.92134 12.51988 12.63277 12.50717 12.70012
[857] 12.71873 13.08639 12.70057 12.91500 12.40078 12.90901 12.96648 12.93132
[865] 12.78731 12.84561 12.16704 12.33373 12.40114 12.71212 12.46723 12.33258
[873] 13.00345 12.62171 12.37996 13.30796 12.12853 12.56919 13.02854 13.11064
[881] 12.76454 12.44002 12.68323 12.40047 12.69058 12.69149 12.17557 12.41308
[889] 11.81346 13.18620 12.78987 12.99143 12.32486 12.36154 12.94888 12.80532
[897] 12.82448 13.05307 12.36936 13.27284 12.85839 13.18187 12.86474 12.87762
[905] 13.01337 12.80673 12.66454 13.27109 13.26353 12.86035 12.77631 13.03918
[913] 12.81001 12.69064 12.75021 12.21326 12.33527 12.65503 12.52550 12.44651
[921] 13.09988 12.33992 12.77949 12.53697 12.97022 12.87777 12.35534 13.00246
[929] 12.02538 12.71177 13.16503 12.90808 13.20945 12.54381 12.43653 13.08576
[937] 12.73611 12.28565 12.47989 12.79289 12.81310 12.71881 12.89071 12.81476
[945] 12.56282 13.18864 12.50076 12.38895 12.74354 12.90815 12.10130 12.58194
[953] 12.90745 13.00963 12.79133 12.49440 12.81798 12.58385 12.93294 12.90904
[961] 12.54683 12.68673 12.12301 12.53382 12.71219 13.05350 13.04097 12.30980
[969] 12.63725 12.63980 12.91040 12.45125 12.94969 12.54995 12.90384 12.72010
[977] 12.25761 12.90073 13.09770 12.75351 12.63983 12.67577 12.20867 13.32519
[985] 12.99994 12.89538 12.85063 12.97943 12.94154 12.42202 12.92416 12.53070
[993] 13.33088 12.69095 12.77155 12.56800 11.87832 12.47613 12.98135</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a>mat <span class="ot">=</span> mtcars</span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a>d1 <span class="ot">&lt;-</span> (<span class="dv">1</span> <span class="sc">-</span> <span class="fu">vegdist</span>(mat, <span class="at">method=</span><span class="st">"bray"</span>)) <span class="sc">*</span> <span class="dv">100</span> </span>
<span id="cb81-3"><a href="#cb81-3" aria-hidden="true" tabindex="-1"></a>h1 <span class="ot">&lt;-</span> <span class="fu">hclust</span>(d1)</span>
<span id="cb81-4"><a href="#cb81-4" aria-hidden="true" tabindex="-1"></a><span class="co"># This plot agrees with the corrgram</span></span>
<span id="cb81-5"><a href="#cb81-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(h1,</span>
<span id="cb81-6"><a href="#cb81-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">axes=</span><span class="cn">FALSE</span>, <span class="at">hang =</span> <span class="sc">-</span><span class="dv">1</span>, </span>
<span id="cb81-7"><a href="#cb81-7" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab=</span><span class="st">""</span>, <span class="at">ylab=</span><span class="st">"DiSimilarity"</span>,</span>
<span id="cb81-8"><a href="#cb81-8" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"mtcars - Bray Curtis method"</span>, <span class="at">sub =</span> <span class="st">""</span>)</span>
<span id="cb81-9"><a href="#cb81-9" aria-hidden="true" tabindex="-1"></a><span class="co"># h1$height has the heights of join points</span></span>
<span id="cb81-10"><a href="#cb81-10" aria-hidden="true" tabindex="-1"></a><span class="co"># original scale was [0, .63]</span></span>
<span id="cb81-11"><a href="#cb81-11" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="at">side=</span><span class="dv">2</span>, <span class="at">at=</span><span class="fu">seq</span>(<span class="dv">0</span>, <span class="fu">max</span>(h1<span class="sc">$</span>height), <span class="at">length=</span><span class="dv">6</span>), <span class="at">labels=</span><span class="fu">seq</span>(<span class="dv">100</span>,<span class="dv">0</span>,<span class="sc">-</span><span class="dv">20</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Primerv7_to_R_code_files/figure-html/unnamed-chunk-72-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a>mat <span class="ot">=</span> mtcars</span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a>d1 <span class="ot">&lt;-</span> <span class="fu">vegdist</span>(mat, <span class="at">method=</span><span class="st">"bray"</span>) <span class="co"># range .001 .633</span></span>
<span id="cb82-3"><a href="#cb82-3" aria-hidden="true" tabindex="-1"></a>h1 <span class="ot">&lt;-</span> <span class="fu">hclust</span>(d1)</span>
<span id="cb82-4"><a href="#cb82-4" aria-hidden="true" tabindex="-1"></a><span class="co"># This plot agrees with the corrgram</span></span>
<span id="cb82-5"><a href="#cb82-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(h1,</span>
<span id="cb82-6"><a href="#cb82-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">axes=</span><span class="cn">FALSE</span>, <span class="at">hang =</span> <span class="sc">-</span><span class="dv">1</span>, </span>
<span id="cb82-7"><a href="#cb82-7" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab=</span><span class="st">""</span>, <span class="at">ylab=</span><span class="st">"Similarity"</span>,</span>
<span id="cb82-8"><a href="#cb82-8" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"mtcars - Bray Curtis method"</span>, <span class="at">sub =</span> <span class="st">""</span>)</span>
<span id="cb82-9"><a href="#cb82-9" aria-hidden="true" tabindex="-1"></a><span class="co"># h1$height has the heights of join points</span></span>
<span id="cb82-10"><a href="#cb82-10" aria-hidden="true" tabindex="-1"></a><span class="co"># original scale was [0, .63]</span></span>
<span id="cb82-11"><a href="#cb82-11" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="at">side=</span><span class="dv">2</span>, <span class="at">at=</span><span class="fu">seq</span>(<span class="dv">0</span>, <span class="fu">max</span>(h1<span class="sc">$</span>height), <span class="at">length=</span><span class="dv">6</span>), <span class="at">labels=</span><span class="fu">seq</span>(<span class="dv">100</span>,<span class="dv">0</span>,<span class="sc">-</span><span class="dv">20</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Primerv7_to_R_code_files/figure-html/unnamed-chunk-74-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a>df<span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"E:/1 Master's/MSU/course classes/Fall 2022/WFA 7000 FALL2022/materials/Primerv7 to R code/Book1.csv"</span>, <span class="at">header =</span> <span class="cn">TRUE</span>,<span class="at">row.names=</span><span class="dv">1</span>)</span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a>mat <span class="ot">=</span> df<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb83-3"><a href="#cb83-3" aria-hidden="true" tabindex="-1"></a>d1 <span class="ot">&lt;-</span> <span class="fu">vegdist</span>(mat, <span class="at">method=</span><span class="st">"bray"</span>) <span class="co"># range .001 .633</span></span>
<span id="cb83-4"><a href="#cb83-4" aria-hidden="true" tabindex="-1"></a>h1 <span class="ot">&lt;-</span> <span class="fu">hclust</span>(d1)</span>
<span id="cb83-5"><a href="#cb83-5" aria-hidden="true" tabindex="-1"></a><span class="co"># This plot agrees with the corrgram</span></span>
<span id="cb83-6"><a href="#cb83-6" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(h1,</span>
<span id="cb83-7"><a href="#cb83-7" aria-hidden="true" tabindex="-1"></a>     <span class="at">axes=</span><span class="cn">FALSE</span>, <span class="at">hang =</span> <span class="sc">-</span><span class="dv">1</span>, </span>
<span id="cb83-8"><a href="#cb83-8" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab=</span><span class="st">""</span>, <span class="at">ylab=</span><span class="st">"Similarity"</span>,</span>
<span id="cb83-9"><a href="#cb83-9" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"mtcars - Bray Curtis method"</span>, <span class="at">sub =</span> <span class="st">""</span>)</span>
<span id="cb83-10"><a href="#cb83-10" aria-hidden="true" tabindex="-1"></a><span class="co"># h1$height has the heights of join points</span></span>
<span id="cb83-11"><a href="#cb83-11" aria-hidden="true" tabindex="-1"></a><span class="co"># original scale was [0, .63]</span></span>
<span id="cb83-12"><a href="#cb83-12" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="at">side=</span><span class="dv">2</span>, <span class="at">at=</span><span class="fu">seq</span>(<span class="dv">0</span>, <span class="fu">max</span>(h1<span class="sc">$</span>height), <span class="at">length=</span><span class="dv">6</span>), <span class="at">labels=</span><span class="fu">seq</span>(<span class="dv">100</span>,<span class="dv">0</span>,<span class="sc">-</span><span class="dv">20</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Primerv7_to_R_code_files/figure-html/unnamed-chunk-76-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<section id="day-5" class="level2">
<h2 class="anchored" data-anchor-id="day-5">Day 5</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a>birds<span class="ot">&lt;-</span><span class="fu">read.csv</span>(<span class="st">'https://raw.githubusercontent.com/collnell/lab-demo/master/bird_by_fg.csv'</span>)</span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a>trees<span class="ot">&lt;-</span><span class="fu">read.csv</span>(<span class="st">'https://raw.githubusercontent.com/collnell/lab-demo/master/tree_comp.csv'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a>bird.matrix<span class="ot">&lt;-</span><span class="fu">as.matrix</span>(birds[,<span class="dv">3</span><span class="sc">:</span><span class="dv">9</span>])<span class="do">##response variables in a sample x species matrix</span></span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a>trees<span class="sc">$</span>B<span class="ot">&lt;-</span><span class="fu">as.factor</span>(trees<span class="sc">$</span>B)</span>
<span id="cb85-3"><a href="#cb85-3" aria-hidden="true" tabindex="-1"></a>bird.manova<span class="ot">&lt;-</span><span class="fu">manova</span>(bird.matrix<span class="sc">~</span><span class="fu">as.factor</span>(B), <span class="at">data=</span>trees) <span class="do">##manova test</span></span>
<span id="cb85-4"><a href="#cb85-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(bird.manova) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>             Df  Pillai approx F num Df den Df  Pr(&gt;F)  
as.factor(B)  1 0.39147   2.2056      7     24 0.07027 .
Residuals    30                                         
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary.aov</span>(bird.manova)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Response CA :
             Df Sum Sq Mean Sq F value Pr(&gt;F)
as.factor(B)  1 0.2449 0.24494  1.3983 0.2463
Residuals    30 5.2551 0.17517               

 Response FR :
             Df Sum Sq  Mean Sq F value Pr(&gt;F)
as.factor(B)  1 0.0062 0.006199  0.0686 0.7952
Residuals    30 2.7125 0.090418               

 Response GR :
             Df Sum Sq Mean Sq F value Pr(&gt;F)
as.factor(B)  1  5.686  5.6862  2.6732 0.1125
Residuals    30 63.814  2.1271               

 Response HE :
             Df  Sum Sq  Mean Sq F value Pr(&gt;F)
as.factor(B)  1 0.02138 0.021382  0.6771 0.4171
Residuals    30 0.94737 0.031579               

 Response IN :
             Df Sum Sq Mean Sq F value Pr(&gt;F)
as.factor(B)  1  73.65  73.655  2.7977 0.1048
Residuals    30 789.81  26.327               

 Response NE :
             Df Sum Sq Mean Sq F value Pr(&gt;F)
as.factor(B)  1 0.3968 0.39676  1.5655 0.2205
Residuals    30 7.6032 0.25344               

 Response OM :
             Df Sum Sq Mean Sq F value Pr(&gt;F)
as.factor(B)  1  19.44  19.441  1.4069 0.2449
Residuals    30 414.56  13.819               </code></pre>
</div>
</div>
<ol type="1">
<li>Transformal</li>
<li>resemblage</li>
<li>permanoava</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a>bird.mat<span class="ot">&lt;-</span><span class="fu">sqrt</span>(bird.matrix)<span class="co">#square root transform</span></span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a>bird.dist<span class="ot">&lt;-</span><span class="fu">vegdist</span>(bird.mat, <span class="at">method=</span><span class="st">'bray'</span>)</span>
<span id="cb89-3"><a href="#cb89-3" aria-hidden="true" tabindex="-1"></a>bird.dist</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            1          2          3          4          5          6          7
2  0.61136859                                                                  
3  0.33333333 0.34919819                                                       
4  0.53326015 0.15324060 0.24314702                                            
5  0.54691816 0.32308204 0.17157288 0.21525044                                 
6  0.70332241 0.16131945 0.48329258 0.27212306 0.46040543                      
7  0.33333333 0.34919819 0.00000000 0.24314702 0.17157288 0.48329258           
8  0.56548939 0.18797110 0.28608138 0.04614414 0.25882380 0.22885259 0.28608138
9  0.31783725 0.36432551 0.13165250 0.25938626 0.30216948 0.49646626 0.13165250
10 0.64031869 0.27728093 0.39028832 0.16256866 0.36504508 0.15009010 0.39028832
11 0.00000000 0.61136859 0.33333333 0.53326015 0.54691816 0.70332241 0.33333333
12 0.54691816 0.32308204 0.17157288 0.21525044 0.00000000 0.46040543 0.17157288
13 0.61401441 0.34387252 0.67645606 0.49887954 0.77562355 0.25944081 0.67645606
14 0.58356587 0.25605328 0.31066339 0.12649698 0.34778817 0.35130514 0.31066339
15 0.56548939 0.18797110 0.28608138 0.04614414 0.25882380 0.22885259 0.28608138
16 0.72754123 0.23802437 0.52041591 0.37762807 0.49861728 0.26303429 0.52041591
17 0.61324320 0.24345665 0.35182873 0.15607334 0.32576539 0.30106633 0.35182873
18 0.54691816 0.32308204 0.17157288 0.21525044 0.00000000 0.46040543 0.17157288
19 0.71599127 0.38237706 0.50261358 0.29559037 0.48028238 0.23339705 0.50261358
20 0.60837273 0.23756138 0.34500284 0.11118252 0.31880333 0.16596176 0.34500284
21 0.65143042 0.14320490 0.40632872 0.30052063 0.43670040 0.23072709 0.40632872
22 0.66463904 0.08973217 0.42559464 0.20350694 0.40118355 0.07263877 0.42559464
23 0.71681417 0.18770497 0.50387598 0.29713243 0.48158190 0.09260034 0.50387598
24 0.68796639 0.22508897 0.46015731 0.31098623 0.43663461 0.33593482 0.46015731
25 0.55683487 0.12626874 0.27444097 0.22361114 0.24699918 0.24078868 0.27444097
26 0.65485688 0.29621346 0.41130566 0.18684455 0.38654863 0.17989575 0.41130566
27 0.41421356 0.74566690 0.58578644 0.69905585 0.60000000 0.80236099 0.58578644
28 0.64731795 0.28632627 0.40037448 0.17418427 0.37536120 0.23317526 0.40037448
29 0.72136194 0.25351449 0.51086912 0.33502554 0.48878247 0.27679305 0.51086912
30 0.22514823 0.44786886 0.44151844 0.35015208 0.61803399 0.56814021 0.44151844
31 0.66761358 0.31329441 0.42996338 0.20862715 0.40566055 0.33022132 0.42996338
32 0.62589308 0.24055117 0.36968817 0.41692739 0.47208752 0.31607884 0.36968817
            8          9         10         11         12         13         14
2                                                                              
3                                                                              
4                                                                              
5                                                                              
6                                                                              
7                                                                              
8                                                                              
9  0.30191672                                                                  
10 0.11730448 0.40488183                                                       
11 0.56548939 0.31783725 0.64031869                                            
12 0.25882380 0.30216948 0.36504508 0.54691816                                 
13 0.51934025 0.59932397 0.43960545 0.61401441 0.77562355                      
14 0.16398662 0.32623912 0.25971183 0.58356587 0.34778817 0.53136850           
15 0.00000000 0.30191672 0.11730448 0.56548939 0.25882380 0.51934025 0.16398662
16 0.33359286 0.53294114 0.39213319 0.72754123 0.49861728 0.50938717 0.30732384
17 0.10880822 0.36692360 0.20654465 0.61324320 0.32576539 0.58527407 0.08102494
18 0.25882380 0.30216948 0.36504508 0.54691816 0.00000000 0.77562355 0.34778817
19 0.25289566 0.51545558 0.13973658 0.71599127 0.48028238 0.52081554 0.22746785
20 0.06537377 0.36018143 0.08435507 0.60837273 0.31880333 0.46043677 0.21725939
21 0.32717581 0.42069827 0.39646820 0.65143042 0.43670040 0.37082702 0.34291636
22 0.23305835 0.43968366 0.16765234 0.66463904 0.40118355 0.24562270 0.29376431
23 0.28570473 0.51669587 0.22231816 0.71681417 0.48158190 0.28265912 0.22907030
24 0.33528532 0.47371155 0.39912955 0.68796639 0.43663461 0.52284012 0.23732163
25 0.21137297 0.29039204 0.30491245 0.55683487 0.24699918 0.49786370 0.33034446
26 0.14192405 0.42560395 0.10604766 0.65485688 0.38654863 0.45422800 0.27987962
27 0.71812092 0.57735027 0.76329932 0.41421356 0.60000000 0.74727025 0.45783311
28 0.12907760 0.41482818 0.16515165 0.64731795 0.37536120 0.52073395 0.26935275
29 0.29164183 0.52356555 0.35481067 0.72136194 0.48878247 0.52908883 0.40748254
30 0.38999489 0.30273374 0.48510664 0.22514823 0.61803399 0.45124872 0.41263301
31 0.16406242 0.44398704 0.24764233 0.66761358 0.40566055 0.59323770 0.29803785
32 0.44024145 0.38455647 0.50042461 0.62589308 0.47208752 0.38107870 0.45396629
           15         16         17         18         19         20         21
2                                                                              
3                                                                              
4                                                                              
5                                                                              
6                                                                              
7                                                                              
8                                                                              
9                                                                              
10                                                                             
11                                                                             
12                                                                             
13                                                                             
14                                                                             
15                                                                             
16 0.33359286                                                                  
17 0.10880822 0.23508659                                                       
18 0.25882380 0.49861728 0.32576539                                            
19 0.25289566 0.32823879 0.18317671 0.48028238                                 
20 0.06537377 0.33917554 0.16306894 0.31880333 0.19067426                      
21 0.32717581 0.18525545 0.37009734 0.43670040 0.47941690 0.36551714           
22 0.23305835 0.29312594 0.31115755 0.40118355 0.27970023 0.19514178 0.21539970
23 0.28570473 0.21480921 0.21430313 0.48158190 0.20067075 0.24927568 0.25360358
24 0.33528532 0.24944365 0.22710649 0.43663461 0.35337277 0.37049038 0.30760103
25 0.21137297 0.28695948 0.26970040 0.24699918 0.41268956 0.26353668 0.23483180
26 0.14192405 0.29479016 0.22727238 0.38654863 0.20265310 0.07726716 0.41129747
27 0.71812092 0.63526633 0.49360547 0.60000000 0.62066362 0.74385341 0.77011942
28 0.12907760 0.28685723 0.21644729 0.37536120 0.25470017 0.09039114 0.40354697
29 0.29164183 0.25973301 0.33054233 0.48878247 0.41032140 0.29936876 0.35633024
30 0.38999489 0.60080816 0.45026308 0.61803399 0.58517583 0.44404748 0.49955046
31 0.16406242 0.29205509 0.24597563 0.40566055 0.34843348 0.21024034 0.27974325
32 0.44024145 0.39648959 0.47759225 0.47208752 0.57167444 0.47361767 0.24051839
           22         23         24         25         26         27         28
2                                                                              
3                                                                              
4                                                                              
5                                                                              
6                                                                              
7                                                                              
8                                                                              
9                                                                              
10                                                                             
11                                                                             
12                                                                             
13                                                                             
14                                                                             
15                                                                             
16                                                                             
17                                                                             
18                                                                             
19                                                                             
20                                                                             
21                                                                             
22                                                                             
23 0.09965125                                                                  
24 0.28615523 0.23125165                                                       
25 0.21052774 0.26625369 0.24997612                                            
26 0.20812940 0.25751955 0.41292140 0.32450914                                 
27 0.77826473 0.62170183 0.58550432 0.71297849 0.77222841                      
28 0.26607207 0.31010058 0.40570740 0.31428514 0.05625373 0.76759188           
29 0.30828464 0.34310334 0.36094732 0.27498149 0.25682013 0.81372279 0.21067043
30 0.51683052 0.58628637 0.54764537 0.51915438 0.50402152 0.52786405 0.49419492
31 0.34172875 0.37687830 0.42544349 0.34212046 0.26560205 0.78010478 0.25621221
32 0.30723563 0.33718249 0.39894168 0.25389213 0.51322556 0.75448869 0.50653860
           29         30         31
2                                  
3                                  
4                                  
5                                  
6                                  
7                                  
8                                  
9                                  
10                                 
11                                 
12                                 
13                                 
14                                 
15                                 
16                                 
17                                 
18                                 
19                                 
20                                 
21                                 
22                                 
23                                 
24                                 
25                                 
26                                 
27                                 
28                                 
29                                 
30 0.59243270                      
31 0.25479959 0.52073863           
32 0.30843495 0.58673774 0.37374728</code></pre>
</div>
</div>
<p>Do monoculture and polyculture plots differ in feeding guild composition? ## PERMANOVA: Permutational multivariate analysis of variance</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">36</span>) <span class="co">#reproducible results</span></span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a>bird.div<span class="ot">&lt;-</span><span class="fu">adonis2</span>(bird.dist <span class="sc">~</span> DIVERSITY, <span class="at">data=</span>birds, <span class="at">permutations =</span> <span class="dv">999</span>,<span class="at">method=</span><span class="st">"bray"</span>)</span>
<span id="cb91-3"><a href="#cb91-3" aria-hidden="true" tabindex="-1"></a>bird.div</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Permutation test for adonis under reduced model
Terms added sequentially (first to last)
Permutation: free
Number of permutations: 999

adonis2(formula = bird.dist ~ DIVERSITY, data = birds, permutations = 999, method = "bray")
          Df SumOfSqs      R2      F Pr(&gt;F)   
DIVERSITY  1  0.32857 0.12174 4.1585  0.005 **
Residual  30  2.37033 0.87826                 
Total     31  2.69890 1.00000                 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(bird.div)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       Df           SumOfSqs            R2               F        
 Min.   : 1.00   Min.   :0.3286   Min.   :0.1217   Min.   :4.159  
 1st Qu.:15.50   1st Qu.:1.3494   1st Qu.:0.5000   1st Qu.:4.159  
 Median :30.00   Median :2.3703   Median :0.8783   Median :4.159  
 Mean   :20.67   Mean   :1.7993   Mean   :0.6667   Mean   :4.159  
 3rd Qu.:30.50   3rd Qu.:2.5346   3rd Qu.:0.9391   3rd Qu.:4.159  
 Max.   :31.00   Max.   :2.6989   Max.   :1.0000   Max.   :4.159  
                                                   NA's   :2      
     Pr(&gt;F)     
 Min.   :0.005  
 1st Qu.:0.005  
 Median :0.005  
 Mean   :0.005  
 3rd Qu.:0.005  
 Max.   :0.005  
 NA's   :2      </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a>dispersion<span class="ot">&lt;-</span><span class="fu">betadisper</span>(bird.dist, <span class="at">group=</span>birds<span class="sc">$</span>DIVERSITY)</span>
<span id="cb95-2"><a href="#cb95-2" aria-hidden="true" tabindex="-1"></a><span class="fu">permutest</span>(dispersion)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Permutation test for homogeneity of multivariate dispersions
Permutation: free
Number of permutations: 999

Response: Distances
          Df  Sum Sq   Mean Sq      F N.Perm Pr(&gt;F)
Groups     1 0.00369 0.0036924 0.2231    999  0.631
Residuals 30 0.49659 0.0165530                     </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(dispersion, <span class="at">hull=</span><span class="cn">FALSE</span>, <span class="at">ellipse=</span><span class="cn">TRUE</span>) <span class="do">##sd ellipse</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Primerv7_to_R_code_files/figure-html/unnamed-chunk-92-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a>birdMDS<span class="ot">&lt;-</span><span class="fu">metaMDS</span>(bird.mat, <span class="at">distance=</span><span class="st">"bray"</span>, <span class="at">k=</span><span class="dv">2</span>, <span class="at">trymax=</span><span class="dv">35</span>, <span class="at">autotransform=</span><span class="cn">TRUE</span>) <span class="do">##k is the number of dimensions</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Run 0 stress 0.1569259 
Run 1 stress 0.1710265 
Run 2 stress 0.1710266 
Run 3 stress 0.1584379 
Run 4 stress 0.1739079 
Run 5 stress 0.1627566 
Run 6 stress 0.1671135 
Run 7 stress 0.1584639 
Run 8 stress 0.3884197 
Run 9 stress 0.1808736 
Run 10 stress 0.1584573 
Run 11 stress 0.158438 
Run 12 stress 0.1584639 
Run 13 stress 0.1840315 
Run 14 stress 0.18157 
Run 15 stress 0.1577386 
Run 16 stress 0.1813472 
Run 17 stress 0.1674284 
Run 18 stress 0.1584573 
Run 19 stress 0.1688845 
Run 20 stress 0.1688847 
Run 21 stress 0.1688844 
Run 22 stress 0.158464 
Run 23 stress 0.1627566 
Run 24 stress 0.1577387 
Run 25 stress 0.1713545 
Run 26 stress 0.1585004 
Run 27 stress 0.1584639 
Run 28 stress 0.1627566 
Run 29 stress 0.1569259 
... Procrustes: rmse 1.733149e-05  max resid 8.608721e-05 
... Similar to previous best
*** Solution reached</code></pre>
</div>
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a>birdMDS <span class="do">##metaMDS takes eaither a distance matrix or your community matrix (then requires method for 'distance=')</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
metaMDS(comm = bird.mat, distance = "bray", k = 2, trymax = 35,      autotransform = TRUE) 

global Multidimensional Scaling using monoMDS

Data:     bird.mat 
Distance: bray 

Dimensions: 2 
Stress:     0.1569259 
Stress type 1, weak ties
Two convergent solutions found after 29 tries
Scaling: centring, PC rotation, halfchange scaling 
Species: expanded scores based on 'bird.mat' </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb102"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a><span class="fu">stressplot</span>(birdMDS)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Primerv7_to_R_code_files/figure-html/unnamed-chunk-96-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a><span class="do">##pull points from MDS</span></span>
<span id="cb103-2"><a href="#cb103-2" aria-hidden="true" tabindex="-1"></a>NMDS1 <span class="ot">&lt;-</span> birdMDS<span class="sc">$</span>points[,<span class="dv">1</span>] <span class="do">##also found using scores(birdMDS)</span></span>
<span id="cb103-3"><a href="#cb103-3" aria-hidden="true" tabindex="-1"></a>NMDS2 <span class="ot">&lt;-</span> birdMDS<span class="sc">$</span>points[,<span class="dv">2</span>]</span>
<span id="cb103-4"><a href="#cb103-4" aria-hidden="true" tabindex="-1"></a>bird.plot<span class="ot">&lt;-</span><span class="fu">cbind</span>(birds, NMDS1, NMDS2, trees)</span>
<span id="cb103-5"><a href="#cb103-5" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(bird.plot) <span class="ot">&lt;-</span> <span class="fu">make.unique</span>(<span class="fu">names</span>(bird.plot))</span>
<span id="cb103-6"><a href="#cb103-6" aria-hidden="true" tabindex="-1"></a><span class="co">#plot ordination</span></span>
<span id="cb103-7"><a href="#cb103-7" aria-hidden="true" tabindex="-1"></a>p<span class="ot">&lt;-</span><span class="fu">ggplot</span>(bird.plot, <span class="fu">aes</span>(NMDS1, NMDS2, <span class="at">color=</span>DIVERSITY))<span class="sc">+</span></span>
<span id="cb103-8"><a href="#cb103-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">position=</span><span class="fu">position_jitter</span>(.<span class="dv">1</span>), <span class="at">shape=</span><span class="dv">3</span>)<span class="sc">+</span><span class="do">##separates overlapping points</span></span>
<span id="cb103-9"><a href="#cb103-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_ellipse</span>(<span class="at">type=</span><span class="st">'t'</span>,<span class="at">size =</span><span class="dv">1</span>)<span class="sc">+</span> <span class="do">##draws 95% confidence interval ellipses</span></span>
<span id="cb103-10"><a href="#cb103-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb103-11"><a href="#cb103-11" aria-hidden="true" tabindex="-1"></a>p</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Primerv7_to_R_code_files/figure-html/unnamed-chunk-98-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb104"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a><span class="co">#plot ordination</span></span>
<span id="cb104-2"><a href="#cb104-2" aria-hidden="true" tabindex="-1"></a>p<span class="ot">&lt;-</span><span class="fu">ggplot</span>(bird.plot, <span class="fu">aes</span>(NMDS1, NMDS2, <span class="at">color=</span>DIVERSITY))<span class="sc">+</span></span>
<span id="cb104-3"><a href="#cb104-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_ellipse</span>(<span class="at">type=</span><span class="st">'t'</span>,<span class="at">size =</span><span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb104-4"><a href="#cb104-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()<span class="sc">+</span><span class="fu">geom_text</span>(<span class="at">data=</span>bird.plot,<span class="fu">aes</span>(NMDS1, NMDS2, <span class="at">label=</span>comp), <span class="at">position=</span><span class="fu">position_jitter</span>(.<span class="dv">35</span>))<span class="sc">+</span></span>
<span id="cb104-5"><a href="#cb104-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x=</span><span class="fu">min</span>(NMDS1), <span class="at">y=</span><span class="fu">min</span>(NMDS2), <span class="at">label=</span><span class="fu">paste</span>(<span class="st">'Stress ='</span>,<span class="fu">round</span>(birdMDS<span class="sc">$</span>stress,<span class="dv">3</span>))) <span class="co">#add stress to plot</span></span>
<span id="cb104-6"><a href="#cb104-6" aria-hidden="true" tabindex="-1"></a>p</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Primerv7_to_R_code_files/figure-html/unnamed-chunk-100-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Which envornmental variables are correlated with the ordination?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb105"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a>fit<span class="ot">&lt;-</span><span class="fu">envfit</span>(birdMDS, bird.mat)</span>
<span id="cb105-2"><a href="#cb105-2" aria-hidden="true" tabindex="-1"></a>arrow<span class="ot">&lt;-</span><span class="fu">data.frame</span>(fit<span class="sc">$</span>vectors<span class="sc">$</span>arrows,<span class="at">R =</span> fit<span class="sc">$</span>vectors<span class="sc">$</span>r, <span class="at">P =</span> fit<span class="sc">$</span>vectors<span class="sc">$</span>pvals)</span>
<span id="cb105-3"><a href="#cb105-3" aria-hidden="true" tabindex="-1"></a>arrow<span class="sc">$</span>FG <span class="ot">&lt;-</span> <span class="fu">rownames</span>(arrow)</span>
<span id="cb105-4"><a href="#cb105-4" aria-hidden="true" tabindex="-1"></a>arrow.p<span class="ot">&lt;-</span><span class="fu">filter</span>(arrow, P <span class="sc">&lt;=</span> <span class="fl">0.05</span>)</span>
<span id="cb105-5"><a href="#cb105-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-6"><a href="#cb105-6" aria-hidden="true" tabindex="-1"></a>p<span class="ot">&lt;-</span><span class="fu">ggplot</span>(<span class="at">data=</span>bird.plot, <span class="fu">aes</span>(NMDS1, NMDS2))<span class="sc">+</span></span>
<span id="cb105-7"><a href="#cb105-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data=</span>bird.plot, <span class="fu">aes</span>(NMDS1, NMDS2, <span class="at">color=</span>DIVERSITY),<span class="at">position=</span><span class="fu">position_jitter</span>(.<span class="dv">1</span>))<span class="sc">+</span><span class="do">##separates overlapping points</span></span>
<span id="cb105-8"><a href="#cb105-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_ellipse</span>(<span class="fu">aes</span>(<span class="at">fill=</span>DIVERSITY), <span class="at">alpha=</span>.<span class="dv">2</span>,<span class="at">type=</span><span class="st">'t'</span>,<span class="at">size =</span><span class="dv">1</span>, <span class="at">geom=</span><span class="st">"polygon"</span>)<span class="sc">+</span> <span class="do">##changes shading on ellipses</span></span>
<span id="cb105-9"><a href="#cb105-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()<span class="sc">+</span></span>
<span id="cb105-10"><a href="#cb105-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="at">data=</span>arrow.p, <span class="fu">aes</span>(<span class="at">x=</span><span class="dv">0</span>, <span class="at">y=</span><span class="dv">0</span>, <span class="at">xend=</span>NMDS1, <span class="at">yend=</span>NMDS2, <span class="at">label=</span>FG, <span class="at">lty=</span>FG), <span class="at">arrow=</span><span class="fu">arrow</span>(<span class="at">length=</span><span class="fu">unit</span>(.<span class="dv">2</span>, <span class="st">"cm"</span>)<span class="sc">*</span>arrow.p<span class="sc">$</span>R)) <span class="do">##add arrows (scaled by R-squared value)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Ignoring unknown aesthetics: label</code></pre>
</div>
<div class="sourceCode cell-code" id="cb107"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a>p</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Primerv7_to_R_code_files/figure-html/unnamed-chunk-102-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb108"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ordisurf</span>(birdMDS, bird.mat[,<span class="st">'IN'</span>], <span class="at">bubble=</span><span class="cn">TRUE</span>)<span class="do">##bubble size reflects abundance of insectivores</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Primerv7_to_R_code_files/figure-html/unnamed-chunk-104-1.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
Family: gaussian 
Link function: identity 

Formula:
y ~ s(x1, x2, k = 10, bs = "tp", fx = FALSE)

Estimated degrees of freedom:
5.68  total = 6.68 

REML score: 35.6389     </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb110"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a><span class="fu">list.files</span>(<span class="st">'E:/R/abundant'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "ENV_pitlatrine.csv" "SPE_pitlatrine.csv"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb112"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a>abund_table <span class="ot">&lt;-</span><span class="fu">read.csv</span>(<span class="fu">paste0</span>(<span class="st">"E:/R/abundant/"</span>,<span class="fu">list.files</span>(<span class="st">'E:/R/abundant'</span>)[<span class="dv">1</span>]), <span class="at">row.names=</span><span class="dv">1</span> ,<span class="at">check.names=</span><span class="cn">FALSE</span>)</span>
<span id="cb112-2"><a href="#cb112-2" aria-hidden="true" tabindex="-1"></a>meta_table<span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="fu">paste0</span>(<span class="st">"E:/R/abundant/"</span>,<span class="fu">list.files</span>(<span class="st">'E:/R/abundant'</span>)[<span class="dv">2</span>]), <span class="at">row.names=</span><span class="dv">1</span> ,<span class="at">check.names=</span><span class="cn">FALSE</span>)</span>
<span id="cb112-3"><a href="#cb112-3" aria-hidden="true" tabindex="-1"></a>meta_table<span class="ot">&lt;-</span> meta_table[<span class="fu">rownames</span>(abund_table),]</span>
<span id="cb112-4"><a href="#cb112-4" aria-hidden="true" tabindex="-1"></a>grouping_info<span class="ot">&lt;-</span><span class="fu">data.frame</span>(<span class="at">row.names=</span><span class="fu">rownames</span>(abund_table),<span class="fu">t</span>(<span class="fu">as.data.frame</span>(<span class="fu">strsplit</span>(<span class="fu">rownames</span>(abund_table),<span class="st">"_"</span>))))</span>
<span id="cb112-5"><a href="#cb112-5" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(abund_table)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>         pH Temp    TS    VS  VFA CODt CODs perCODsbyt NH4 Prot Carbo
T_2_1  7.82 25.1 14.53 71.33 71.0  874  311         36 3.3 35.4    22
T_2_10 9.08 24.2 37.76 31.52  2.0  102    9          9 1.2 18.4    43
T_2_12 8.84 25.1 71.11  5.94  1.0   35    4         10 0.5  0.0    17
T_2_2  6.49 29.6 13.91 64.93  3.7  389  180         46 6.2 29.3    25
T_2_3  6.46 27.9 29.45 26.85 27.5  161   35         22 2.4 19.4    31
T_2_6  7.69 28.7 65.52  7.03  1.5   57    3          6 0.8  0.0    14</code></pre>
</div>
<div class="sourceCode cell-code" id="cb114"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Get MDS stats</span></span>
<span id="cb114-2"><a href="#cb114-2" aria-hidden="true" tabindex="-1"></a>sol<span class="ot">&lt;-</span><span class="fu">metaMDS</span>(abund_table,<span class="at">distance =</span> <span class="st">"bray"</span>, <span class="at">k =</span> <span class="dv">2</span>, <span class="at">trymax =</span> <span class="dv">50</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Square root transformation
Wisconsin double standardization
Run 0 stress 0.1042866 
Run 1 stress 0.1069761 
Run 2 stress 0.1332556 
Run 3 stress 0.1313334 
Run 4 stress 0.1069761 
Run 5 stress 0.1069761 
Run 6 stress 0.1325276 
Run 7 stress 0.1042866 
... New best solution
... Procrustes: rmse 6.395407e-06  max resid 4.743477e-05 
... Similar to previous best
Run 8 stress 0.1325276 
Run 9 stress 0.1042866 
... Procrustes: rmse 7.686444e-06  max resid 5.226912e-05 
... Similar to previous best
Run 10 stress 0.1069761 
Run 11 stress 0.1069761 
Run 12 stress 0.1068974 
Run 13 stress 0.1042866 
... Procrustes: rmse 5.569205e-06  max resid 3.016096e-05 
... Similar to previous best
Run 14 stress 0.1313334 
Run 15 stress 0.1346498 
Run 16 stress 0.1042866 
... Procrustes: rmse 9.111336e-07  max resid 4.878003e-06 
... Similar to previous best
Run 17 stress 0.1346498 
Run 18 stress 0.1042866 
... Procrustes: rmse 1.487243e-06  max resid 7.606903e-06 
... Similar to previous best
Run 19 stress 0.1346498 
Run 20 stress 0.1313334 
*** Solution reached</code></pre>
</div>
<div class="sourceCode cell-code" id="cb116"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Make a new data frame, and put country, latrine, and depth information there, to be useful for coloring, and shape of points</span></span>
<span id="cb116-2"><a href="#cb116-2" aria-hidden="true" tabindex="-1"></a>NMDS<span class="ot">=</span><span class="fu">data.frame</span>(<span class="at">x=</span>sol<span class="sc">$</span>point[,<span class="dv">1</span>],<span class="at">y=</span>sol<span class="sc">$</span>point[,<span class="dv">2</span>],<span class="at">Country=</span><span class="fu">as.factor</span>(grouping_info[,<span class="dv">1</span>]),<span class="at">Latrine=</span><span class="fu">as.factor</span>(grouping_info[,<span class="dv">2</span>]),<span class="at">Depth=</span><span class="fu">as.factor</span>(grouping_info[,<span class="dv">3</span>]))</span>
<span id="cb116-3"><a href="#cb116-3" aria-hidden="true" tabindex="-1"></a><span class="co">#Generate mean values from NMDS plot grouped on Countries</span></span>
<span id="cb116-4"><a href="#cb116-4" aria-hidden="true" tabindex="-1"></a>NMDS.mean<span class="ot">=</span><span class="fu">aggregate</span>(NMDS[,<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>],<span class="fu">list</span>(<span class="at">group=</span>NMDS<span class="sc">$</span>Country),mean)<span class="co">#Generate mean values from </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="shadeplot-means-heatmap" class="level2">
<h2 class="anchored" data-anchor-id="shadeplot-means-heatmap">shadeplot means heatmap</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb117"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gplots)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'gplots' was built under R version 4.1.3</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'gplots'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:stats':

    lowess</code></pre>
</div>
<div class="sourceCode cell-code" id="cb121"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb121-1"><a href="#cb121-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(RColorBrewer)</span>
<span id="cb121-2"><a href="#cb121-2" aria-hidden="true" tabindex="-1"></a>meta_table<span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="fu">paste0</span>(<span class="st">"E:/R/abundant/"</span>,<span class="fu">list.files</span>(<span class="st">'E:/R/abundant'</span>)[<span class="dv">2</span>]), <span class="at">row.names=</span><span class="dv">1</span> ,<span class="at">check.names=</span><span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb122"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb122-1"><a href="#cb122-1" aria-hidden="true" tabindex="-1"></a>data.dist<span class="ot">&lt;-</span> <span class="fu">vegdist</span>(<span class="fu">as.matrix</span>(meta_table),<span class="at">method=</span><span class="st">'bray'</span>)</span>
<span id="cb122-2"><a href="#cb122-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">hclust</span>(data.dist),<span class="at">cex=</span><span class="fl">0.6</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Primerv7_to_R_code_files/figure-html/unnamed-chunk-110-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb123"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb123-1"><a href="#cb123-1" aria-hidden="true" tabindex="-1"></a>sub_grop<span class="ot">&lt;-</span> <span class="fu">cutree</span>(<span class="fu">hclust</span>(data.dist),<span class="at">k=</span><span class="dv">2</span>)</span>
<span id="cb123-2"><a href="#cb123-2" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_cluster</span>(<span class="fu">list</span>(<span class="at">data =</span> meta_table, <span class="at">cluster =</span> sub_grop))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Primerv7_to_R_code_files/figure-html/unnamed-chunk-112-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb124"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb124-1"><a href="#cb124-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute distance matrix</span></span>
<span id="cb124-2"><a href="#cb124-2" aria-hidden="true" tabindex="-1"></a>res.dist <span class="ot">&lt;-</span> <span class="fu">dist</span>(meta_table, <span class="at">method =</span> <span class="st">"euclidean"</span>)</span>
<span id="cb124-3"><a href="#cb124-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb124-4"><a href="#cb124-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute 2 hierarchical clusterings</span></span>
<span id="cb124-5"><a href="#cb124-5" aria-hidden="true" tabindex="-1"></a>hc1 <span class="ot">&lt;-</span> <span class="fu">hclust</span>(res.dist, <span class="at">method =</span> <span class="st">"complete"</span>)</span>
<span id="cb124-6"><a href="#cb124-6" aria-hidden="true" tabindex="-1"></a>hc2 <span class="ot">&lt;-</span> <span class="fu">hclust</span>(res.dist, <span class="at">method =</span> <span class="st">"ward.D2"</span>)</span>
<span id="cb124-7"><a href="#cb124-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb124-8"><a href="#cb124-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Create two dendrograms</span></span>
<span id="cb124-9"><a href="#cb124-9" aria-hidden="true" tabindex="-1"></a>dend1 <span class="ot">&lt;-</span> <span class="fu">as.dendrogram</span> (hc1)</span>
<span id="cb124-10"><a href="#cb124-10" aria-hidden="true" tabindex="-1"></a>dend2 <span class="ot">&lt;-</span> <span class="fu">as.dendrogram</span> (hc2)</span>
<span id="cb124-11"><a href="#cb124-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb124-12"><a href="#cb124-12" aria-hidden="true" tabindex="-1"></a><span class="fu">tanglegram</span>(dend1, dend2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Primerv7_to_R_code_files/figure-html/unnamed-chunk-114-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb125"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb125-1"><a href="#cb125-1" aria-hidden="true" tabindex="-1"></a>dend_list <span class="ot">&lt;-</span> <span class="fu">dendlist</span>(dend1, dend2)</span>
<span id="cb125-2"><a href="#cb125-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-3"><a href="#cb125-3" aria-hidden="true" tabindex="-1"></a><span class="fu">tanglegram</span>(dend1, dend2,</span>
<span id="cb125-4"><a href="#cb125-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">highlight_distinct_edges =</span> <span class="cn">FALSE</span>, <span class="co"># Turn-off dashed lines</span></span>
<span id="cb125-5"><a href="#cb125-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">common_subtrees_color_lines =</span> <span class="cn">FALSE</span>, <span class="co"># Turn-off line colors</span></span>
<span id="cb125-6"><a href="#cb125-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">common_subtrees_color_branches =</span> <span class="cn">TRUE</span>, <span class="co"># Color common branches </span></span>
<span id="cb125-7"><a href="#cb125-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">main =</span> <span class="fu">paste</span>(<span class="st">"entanglement ="</span>, <span class="fu">round</span>(<span class="fu">entanglement</span>(dend_list), <span class="dv">2</span>))</span>
<span id="cb125-8"><a href="#cb125-8" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Primerv7_to_R_code_files/figure-html/unnamed-chunk-116-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb126"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb126-1"><a href="#cb126-1" aria-hidden="true" tabindex="-1"></a>colpal<span class="ot">&lt;-</span> <span class="fu">colorRampPalette</span>(<span class="fu">c</span>(<span class="st">'lightyellow'</span>,<span class="st">'red'</span>),<span class="at">space=</span><span class="st">'rgb'</span>)(<span class="dv">100</span>)</span>
<span id="cb126-2"><a href="#cb126-2" aria-hidden="true" tabindex="-1"></a>transform1<span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">as.matrix</span>(meta_table))</span>
<span id="cb126-3"><a href="#cb126-3" aria-hidden="true" tabindex="-1"></a><span class="fu">heatmap</span>(transform1,<span class="at">col=</span>colpal)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Primerv7_to_R_code_files/figure-html/unnamed-chunk-118-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb127"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb127-1"><a href="#cb127-1" aria-hidden="true" tabindex="-1"></a>data.dist<span class="ot">&lt;-</span> <span class="fu">vegdist</span>(<span class="fu">as.matrix</span>(meta_table),<span class="at">method=</span><span class="st">'bray'</span>)</span>
<span id="cb127-2"><a href="#cb127-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Do average linkage hierarchical clustering. Other options are 'complete' or 'single'. You'll need to choose the one that best fits the needs of your situation and your data.</span></span>
<span id="cb127-3"><a href="#cb127-3" aria-hidden="true" tabindex="-1"></a>row.clus <span class="ot">&lt;-</span> <span class="fu">hclust</span>(data.dist, <span class="st">"aver"</span>)</span>
<span id="cb127-4"><a href="#cb127-4" aria-hidden="true" tabindex="-1"></a><span class="fu">heatmap</span>(<span class="fu">as.matrix</span>(meta_table), <span class="at">Rowv =</span> <span class="fu">as.dendrogram</span>(row.clus), <span class="at">col =</span> colpal, <span class="at">margins =</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">3</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Primerv7_to_R_code_files/figure-html/unnamed-chunk-120-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb128"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb128-1"><a href="#cb128-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(mtcars)</span>
<span id="cb128-2"><a href="#cb128-2" aria-hidden="true" tabindex="-1"></a> x  <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(mtcars)</span>
<span id="cb128-3"><a href="#cb128-3" aria-hidden="true" tabindex="-1"></a> rc <span class="ot">&lt;-</span> <span class="fu">rainbow</span>(<span class="fu">nrow</span>(x), <span class="at">start=</span><span class="dv">0</span>, <span class="at">end=</span>.<span class="dv">3</span>)</span>
<span id="cb128-4"><a href="#cb128-4" aria-hidden="true" tabindex="-1"></a> cc <span class="ot">&lt;-</span> <span class="fu">rainbow</span>(<span class="fu">ncol</span>(x), <span class="at">start=</span><span class="dv">0</span>, <span class="at">end=</span>.<span class="dv">3</span>)</span>
<span id="cb128-5"><a href="#cb128-5" aria-hidden="true" tabindex="-1"></a> <span class="fu">heatmap.2</span>(x,<span class="at">trace =</span> <span class="st">"none"</span>, <span class="at">density.info =</span> <span class="st">"none"</span>,</span>
<span id="cb128-6"><a href="#cb128-6" aria-hidden="true" tabindex="-1"></a>           <span class="at">key.title=</span><span class="cn">NA</span>, <span class="co"># no title</span></span>
<span id="cb128-7"><a href="#cb128-7" aria-hidden="true" tabindex="-1"></a>           <span class="at">key.xlab=</span><span class="cn">NA</span>,  <span class="co"># no xlab</span></span>
<span id="cb128-8"><a href="#cb128-8" aria-hidden="true" tabindex="-1"></a>           <span class="at">key.par=</span><span class="fu">list</span>(<span class="at">mgp=</span><span class="fu">c</span>(<span class="fl">1.5</span>, <span class="fl">0.5</span>, <span class="dv">0</span>),</span>
<span id="cb128-9"><a href="#cb128-9" aria-hidden="true" tabindex="-1"></a>                        <span class="at">mar=</span><span class="fu">c</span>(<span class="fl">2.5</span>, <span class="fl">2.5</span>, <span class="dv">1</span>, <span class="dv">0</span>)),</span>
<span id="cb128-10"><a href="#cb128-10" aria-hidden="true" tabindex="-1"></a>           <span class="at">key.xtickfun=</span><span class="cf">function</span>() {</span>
<span id="cb128-11"><a href="#cb128-11" aria-hidden="true" tabindex="-1"></a>                 breaks <span class="ot">&lt;-</span> <span class="fu">parent.frame</span>()<span class="sc">$</span>breaks</span>
<span id="cb128-12"><a href="#cb128-12" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">return</span>(<span class="fu">list</span>(</span>
<span id="cb128-13"><a href="#cb128-13" aria-hidden="true" tabindex="-1"></a>                      <span class="at">at=</span><span class="fu">parent.frame</span>()<span class="sc">$</span><span class="fu">scale01</span>(<span class="fu">c</span>(breaks[<span class="dv">1</span>],</span>
<span id="cb128-14"><a href="#cb128-14" aria-hidden="true" tabindex="-1"></a>                                                  breaks[<span class="fu">length</span>(breaks)])),</span>
<span id="cb128-15"><a href="#cb128-15" aria-hidden="true" tabindex="-1"></a>                      <span class="at">labels=</span><span class="fu">c</span>(<span class="fu">as.character</span>(breaks[<span class="dv">1</span>]),</span>
<span id="cb128-16"><a href="#cb128-16" aria-hidden="true" tabindex="-1"></a>                               <span class="fu">as.character</span>(breaks[<span class="fu">length</span>(breaks)]))</span>
<span id="cb128-17"><a href="#cb128-17" aria-hidden="true" tabindex="-1"></a>                      ))</span>
<span id="cb128-18"><a href="#cb128-18" aria-hidden="true" tabindex="-1"></a>           })</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Primerv7_to_R_code_files/figure-html/unnamed-chunk-122-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb129"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb129-1"><a href="#cb129-1" aria-hidden="true" tabindex="-1"></a><span class="fu">heatmap.2</span>(<span class="fu">as.matrix</span>(meta_table), <span class="at">Rowv =</span> <span class="fu">as.dendrogram</span>(row.clus), <span class="at">col =</span> colpal,</span>
<span id="cb129-2"><a href="#cb129-2" aria-hidden="true" tabindex="-1"></a>          <span class="at">trace =</span> <span class="st">"none"</span>, <span class="at">density.info =</span> <span class="st">"none"</span>, <span class="at">xlab =</span> <span class="st">"genera"</span>, <span class="at">ylab =</span> <span class="st">"Samples"</span>, <span class="at">main =</span> <span class="st">"Heatmap example"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Primerv7_to_R_code_files/figure-html/unnamed-chunk-124-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Pythonic code</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb130"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb130-1"><a href="#cb130-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb130-2"><a href="#cb130-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb130-3"><a href="#cb130-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb130-4"><a href="#cb130-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb130-5"><a href="#cb130-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.manifold <span class="im">import</span> MDS</span>
<span id="cb130-6"><a href="#cb130-6" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics.pairwise <span class="im">import</span> manhattan_distances, euclidean_distances</span>
<span id="cb130-7"><a href="#cb130-7" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy.spatial.distance <span class="im">import</span> braycurtis</span>
<span id="cb130-8"><a href="#cb130-8" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> matplotlib.offsetbox <span class="im">import</span> OffsetImage, AnnotationBbox</span>
<span id="cb130-9"><a href="#cb130-9" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> sklearn.datasets <span class="im">as</span> dt</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb131"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb131-1"><a href="#cb131-1" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> np.array([[<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>], [<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>], [<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>], [<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>], [<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>]])</span>
<span id="cb131-2"><a href="#cb131-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span> (X)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[0 0 0]
 [0 0 1]
 [1 1 1]
 [0 1 0]
 [0 1 1]]</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb133"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb133-1"><a href="#cb133-1" aria-hidden="true" tabindex="-1"></a>dist_man<span class="op">=</span>manhattan_distances(X)</span>
<span id="cb133-2"><a href="#cb133-2" aria-hidden="true" tabindex="-1"></a>mds<span class="op">=</span>MDS(dissimilarity<span class="op">=</span><span class="st">'precomputed'</span>, random_state<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb133-3"><a href="#cb133-3" aria-hidden="true" tabindex="-1"></a>Y_trans<span class="op">=</span>mds.fit_transform(dist_man)</span>
<span id="cb133-4"><a href="#cb133-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(Y_trans)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[ 0.9847767   0.84738596]
 [ 0.81047787 -0.37601578]
 [-1.104849   -1.06040621]
 [-0.29311254  0.87364759]
 [-0.39729303 -0.28461157]]</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb135"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb135-1"><a href="#cb135-1" aria-hidden="true" tabindex="-1"></a>colors <span class="op">=</span> [<span class="st">'r'</span>, <span class="st">'g'</span>, <span class="st">'b'</span>, <span class="st">'c'</span>, <span class="st">'m'</span>]</span>
<span id="cb135-2"><a href="#cb135-2" aria-hidden="true" tabindex="-1"></a>size <span class="op">=</span> [<span class="dv">64</span>, <span class="dv">64</span>, <span class="dv">64</span>, <span class="dv">64</span>, <span class="dv">64</span>]</span>
<span id="cb135-3"><a href="#cb135-3" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> plt.figure(<span class="dv">2</span>, (<span class="dv">10</span>,<span class="dv">4</span>))</span>
<span id="cb135-4"><a href="#cb135-4" aria-hidden="true" tabindex="-1"></a>ax<span class="op">=</span>fig.add_subplot(<span class="dv">121</span>,projection<span class="op">=</span><span class="st">'3d'</span>)</span>
<span id="cb135-5"><a href="#cb135-5" aria-hidden="true" tabindex="-1"></a>plt.scatter(X[:,<span class="dv">0</span>],X[:,<span class="dv">1</span>],zs<span class="op">=</span>X[:,<span class="dv">2</span>],s<span class="op">=</span>size,c<span class="op">=</span>colors)</span>
<span id="cb135-6"><a href="#cb135-6" aria-hidden="true" tabindex="-1"></a>ax.set_xlabel(<span class="st">'X'</span>)</span>
<span id="cb135-7"><a href="#cb135-7" aria-hidden="true" tabindex="-1"></a>ax.set_ylabel(<span class="st">'Y'</span>)</span>
<span id="cb135-8"><a href="#cb135-8" aria-hidden="true" tabindex="-1"></a>ax.set_zlabel(<span class="st">'Z'</span>)</span>
<span id="cb135-9"><a href="#cb135-9" aria-hidden="true" tabindex="-1"></a>ax.set_title(<span class="st">'Original Data'</span>)</span>
<span id="cb135-10"><a href="#cb135-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-11"><a href="#cb135-11" aria-hidden="true" tabindex="-1"></a>ax<span class="op">=</span>fig.add_subplot(<span class="dv">122</span>)</span>
<span id="cb135-12"><a href="#cb135-12" aria-hidden="true" tabindex="-1"></a>plt.scatter(Y_trans[:,<span class="dv">0</span>],Y_trans[:,<span class="dv">1</span>],s<span class="op">=</span>size, c<span class="op">=</span>colors)</span>
<span id="cb135-13"><a href="#cb135-13" aria-hidden="true" tabindex="-1"></a>ax.set_title(<span class="st">'MDS'</span>)</span>
<span id="cb135-14"><a href="#cb135-14" aria-hidden="true" tabindex="-1"></a>ax.set_xlabel(<span class="st">'MDS1'</span>)</span>
<span id="cb135-15"><a href="#cb135-15" aria-hidden="true" tabindex="-1"></a>ax.set_ylabel(<span class="st">'MDS2'</span>)</span>
<span id="cb135-16"><a href="#cb135-16" aria-hidden="true" tabindex="-1"></a>fig.subplots_adjust(wspace<span class="op">=</span><span class="fl">0.4</span>, hspace<span class="op">=</span><span class="fl">0.5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      let href = ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script>
</div> <!-- /content -->



</body></html>